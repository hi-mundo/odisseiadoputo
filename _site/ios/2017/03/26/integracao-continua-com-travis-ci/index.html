<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento ‚Äî artigos, tutoriais e opini√£o.">

    <title>Integra√ß√£o Cont√≠nua com Travis-CI - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/ios/2017/03/26/integracao-continua-com-travis-ci/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Integra√ß√£o Cont√≠nua com Travis-CI</h1>
                        
                        <h2 class="subheading">Chegou a hora de ter menos dores de cabe√ßa durante o desenvolvimento do seu app.</h2>
                        
                        <span class="meta">Postado por Fabricio Serralvo em 26/03/2017</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Integra√ß√£o Cont√≠nua com Travis-CI&url=http://localhost:4000/ios/2017/03/26/integracao-continua-com-travis-ci/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/ios/2017/03/26/integracao-continua-com-travis-ci/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/ios/2017/03/26/integracao-continua-com-travis-ci/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/ios/2017/03/26/integracao-continua-com-travis-ci/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<h1 id="integra√ß√£o-cont√≠nua-com-travisci">Integra√ß√£o Cont√≠nua com Travis¬†CI</h1>
<p>Integra√ß√£o Cont√≠nua √©, em outras palavras, a pr√°tica que busca manter o ambiente de desenvolvimento em pleno funcionamento ap√≥s itera√ß√µes feitas pelos devs do projeto. Para que isso ocorra, √© necess√°rio que a cada altera√ß√£o no reposit√≥rio, alguns itens do projeto sejam verificados, como a gera√ß√£o da <em>build</em> e execu√ß√£o de testes, por exemplo.</p>

<p>Voc√™ pode ler um pouco mais sobre o assunto <a href="https://martinfowler.com/articles/continuousIntegration.html">aqui (conte√∫do em ingl√™s)</a>.</p>

<h1 id="travis-ci">Travis CI</h1>

<p>O Travis CI √© um servi√ßo dedicado exclusivamente √† integra√ß√£o cont√≠nua. Ele opera integrado ao GitHub, assim, algumas tarefas s√£o simplificadas, como a automa√ß√£o da obten√ß√£o do <em>source</em> do projeto. Devido √† integra√ß√£o, √© necess√°rio que seu projeto esteja hospedado no GitHub.</p>

<p>O uso do Travis para projetos <em>open source</em> √© gratuito üéâ (isso sem d√∫vida ajudou a populariz√°-lo). Para utiliz√°-lo em projetos privados voc√™ ter√° que desembolsar alguns d√≥lares, o valor mensal* vai de $69 no plano <em>Bootstrap</em> at√© $489 üí∏ na op√ß√£o <em>Premium</em>.</p>

<p>Para come√ßar a utilizar basta acessar <a href="https://travis-ci.org">travis-ci.org</a> para projetos <em>open source</em> ou <a href="https://travis-ci.com">travis-ci.com</a> para projetos privados. O processo de <em>sign-up</em> √© bastante simples.</p>

<p>* Informa√ß√µes de mar√ßo, 2017</p>

<h1 id="benef√≠cios">Benef√≠cios</h1>

<p>Entre os benef√≠cios do uso do Travis (ou qualquer outra solu√ß√£o de integra√ß√£o cont√≠nua) destaco a velocidade em que os problemas corriqueiros s√£o encontrados, afinal, quanto mais r√°pido descobrirmos alguma adversidade, menor a chance de uma dor de cabe√ßa das grandes.¬†</p>

<p>Outro ponto interessante √© a integra√ß√£o realizada pelo Travis com o GitHub, onde a cada <em>commit</em> ou <em>pull request</em>, o Travis executa seu <em>job</em> e marca visualmente se o ambiente foi comprometido ou n√£o. Al√©m tamb√©m da gera√ß√£o dos tradicionais <em>badges</em> informando o <em>status</em> do projeto.</p>

<p><img src="/img/serralvo/commits-travis.png" alt="" /></p>

<p><em>Marca√ß√£o visual do status da build</em></p>

<h1 id="hora-doshow">Hora do¬†Show</h1>

<p>Para exemplificar o funcionamento do Travis criei um projeto para iOS em Swift 3. Nele, adicionei uma depend√™ncia que servir√° para demonstrar como obter as bibliotecas ou frameworks do projeto.</p>

<p>Esse projeto gerou tr√™s √≠tens para explorarmos:¬†</p>

<ul>
  <li>Ser√° necess√°rio gerenciar as depend√™ncias do projeto‚Ää‚Äî‚Ää sim, √© isso que voc√™ est√° pensando: CocoaPods.</li>
  <li>Execu√ß√£o da <em>build</em>.</li>
  <li>Por fim, notificaremos o time sobre o <em>status</em> do projeto.</li>
</ul>

<h1 id="arquivotravisyml">Arquivo¬†.travis.yml</h1>

<p>Para que essas tarefas listadas acima funcionem, n√≥s precisaremos criar um arquivo que fornecer√° instru√ß√µes para o Travis. A√≠ √© que entra o¬†<code class="language-plaintext highlighter-rouge">.travis.yml</code>.</p>

<p>Antes de come√ßarmos a escrever o arquivo de configura√ß√£o, precisamos entender como funciona o ciclo de vida do processo de <em>build</em> do Travis:</p>

<p>O Travis divide a execu√ß√£o do <em>job</em> em duas etapas, a primeira delas √© respons√°vel pela atualiza√ß√£o das depend√™ncias, seja do projeto, ou do ambiente. A segunda etapa √© voltada para a execu√ß√£o da <em>build</em> e outras tarefas relacionadas, como <em>tests</em>, <em>reports</em> e <em>deploy</em>. Nessas etapas podemos detectar eventos do ciclo de vida e incluir a√ß√µes de acordo com a necessidade do projeto.</p>

<p>Para come√ßarmos, o primeiro passo √© realizar o cadastro no Travis. Para reposit√≥rios p√∫blicos ou privados, o funcionamento ser√° o mesmo.</p>

<p><img src="/img/serralvo/travis-ci-org.png" alt="" /></p>

<p>O pr√≥ximo passo √© ‚Äúativar‚Äù o Travis para o reposit√≥rio desejado. Feito isso, no pr√≥ximo <em>commit</em> ou <em>pull request</em>, o <em>job</em> ser√° executado.</p>

<p><img src="/img/serralvo/start-travis.png" alt="" /></p>

<p>Ap√≥s o cadastro chegou a hora de criar o arquivo¬†<em>.travis.yml</em> na raiz do reposit√≥rio. Feito isso, vamos incluir duas linhas: A primeira √© usada para definir a linguagem do projeto (que √© um valor obrigat√≥rio). No caso adicionaremos <code class="language-plaintext highlighter-rouge">objective-c</code>. A segunda representa a imagem que ser√° usada para fazer a build do projeto, no caso, adicionaremos <code class="language-plaintext highlighter-rouge">xcode8.1</code>. Veja abaixo:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>language: objective-c
osx_image: xcode8.1
</code></pre></div></div>

<p>Agora voc√™ pode estar assim: ü§î</p>

<p>U√©, <code class="language-plaintext highlighter-rouge">objective-c</code>?! Mas o projeto n√£o est√° escrito em Swift? Sim, isso mesmo, at√© o momento o Travis utiliza o valor <code class="language-plaintext highlighter-rouge">objective-c</code> para Swift e tamb√©m para Objective-C.</p>

<h2 id="baixando-as-depend√™ncias">Baixando as depend√™ncias</h2>

<p>Se voc√™ j√° usou CocoaPods ao menos uma vez, sabe que basta executar <code class="language-plaintext highlighter-rouge">pod install</code> para obter as depend√™ncias do projeto. No ambiente do Travis isso √© um pouco diferente: se o <code class="language-plaintext highlighter-rouge">Podfile</code> estiver na raiz do projeto, o Travis far√° o <em>fetch</em> automaticamente, caso contr√°rio, basta indicar no <code class="language-plaintext highlighter-rouge">.travis.yml</code> qual o local de tal arquivo:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>podfile: path/to/Podfile
</code></pre></div></div>

<p>Se o seu projeto usa outro gerenciador de depend√™ncias, √© poss√≠vel fazer <em>override</em> da etapa de <code class="language-plaintext highlighter-rouge">install</code> para realizar a instala√ß√£o de acordo com sua necessidade:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>install: sh dependencies.sh
</code></pre></div></div>

<h2 id="build-e-sucesso">Build e Sucesso</h2>

<p>Ap√≥s obter as depend√™ncias do projeto, basta apenas configurar alguns par√¢metros para a execu√ß√£o da <em>build</em>. Esses par√¢metros envolvem alguns √≠tens necess√°rios para continuar o processo. S√£o eles:</p>

<ul>
  <li><em>Path</em> do <code class="language-plaintext highlighter-rouge">xcworkspace</code> ou <code class="language-plaintext highlighter-rouge">xcproject</code>.</li>
  <li>Algum <em>scheme</em> com a op√ß√£o <em>shared</em> ativada (<a href="http://help.apple.com/xcode/mac/8.0/#/dev5426ddfcf">saiba mais aqui</a>).</li>
  <li>SDK que ser√° usado (no caso estamos usando <code class="language-plaintext highlighter-rouge">iphonesimulator</code>).</li>
</ul>

<p>Conhecendo tais par√¢metros √© hora de realizar a <em>build</em> do projeto, para isso, vamos adicionar na etapa <code class="language-plaintext highlighter-rouge">script</code> a chamada do <code class="language-plaintext highlighter-rouge">xcodebuild</code>.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>script:
  - xcodebuild -workspace DemoTravisCI.xcworkspace -scheme 'DemoTravisCI' -sdk iphonesimulator build
</code></pre></div></div>

<p>Sendo assim, no momento o arquivo <code class="language-plaintext highlighter-rouge">.travis.yml</code> possui o seguinte conte√∫do:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>language: objective-c
osx_image: xcode8.1

script:
  - xcodebuild -workspace DemoTravisCI.xcworkspace  -scheme DemoTravisCI -sdk iphonesimulator build
</code></pre></div></div>

<h2 id="notifica√ß√µes">Notifica√ß√µes</h2>

<p>Para detectar poss√≠veis problemas com o projeto, √© interessante compartilhar o status da <em>build</em> com o time a cada itera√ß√£o. O Travis prov√™ diversas op√ß√µes para notifica√ß√µes, come√ßando pelo envio de e-mails e abrindo um leque de possibilidades gra√ßas √†s integra√ß√µes. No nosso caso, vamos ser avisados via Slack üì¢.</p>

<p>Para isso, o primeiro passo √© adicionar uma <a href="https://my.slack.com/services/new/travis">nova integra√ß√£o ao Slack</a>. Ap√≥s selecionar o time e as demais op√ß√µes, na pr√≥pria p√°gina do Slack voc√™ encontrar√° o conte√∫do que deve ser adicionado ao seu arquivo de configura√ß√£o.</p>

<p>Conclu√≠do tal passo, vamos incluir a chave <code class="language-plaintext highlighter-rouge">notifications</code> no arquivo <code class="language-plaintext highlighter-rouge">.travis.yml</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>notifications:
  slack: yourteam:G1P621hDDwEH3pXeCcJpck8i
</code></pre></div></div>

<p>Importante: Caso seu projeto seja aberto, √© recomendado criptografar a chave. Esse √© um processo bastante simples e voc√™ pode saber mais <a href="https://docs.travis-ci.com/user/encryption-keys/">aqui</a>.</p>

<h1 id="considera√ß√µes-finais">Considera√ß√µes Finais</h1>

<p>Ferramentas de integra√ß√£o cont√≠nua s√£o realidade no mercado e fazem parte da rotina de qualquer grande projeto de software. Algumas demandam maior esfor√ßo para que sejam configuradas (principalmente ferramentas <em>self-hosted</em>), outras n√£o, como √© o caso do Travis, onde basta um arquivo de marca√ß√£o para que a m√°gica aconte√ßa.</p>

<p>Se voc√™ se interessou pelo assunto e deseja implantar tal processo em seus projetos, e por alguma limita√ß√£o n√£o ir√° conseguir utilizar o Travis, saiba que existem diversas op√ß√µes, como Jenkins, Xcode Server, CircleCI, entre outras.</p>

<p>Para finalizar, Integra√ß√£o Cont√≠nua √© um dos pilares do desenvolvimento √°gil, e podemos considerar que tamb√©m √© um passo para a Entrega Cont√≠nua, mas isso √© assunto para outro artigo üôÉ.</p>

<p>Um obrigado especial ao <a href="https://github.com/rogerluan">Roger Oba</a> e tamb√©m ao <a href="https://github.com/ciceroduarte">C√≠cero Duarte</a>.</p>

<h3 id="referencias">Referencias:</h3>

<ul>
  <li><a href="https://unsplash.com/photos/zlABb6Gke24">Imagem da Capa - Relax by Clem Onojeghuo</a></li>
  <li><a href="https://docs.travis-ci.com/user/getting-started/">Getting started</a></li>
  <li><a href="https://docs.travis-ci.com/user/languages/objective-c/">Building an Objective-C Project</a></li>
  <li><a href="https://docs.travis-ci.com/user/notifications/">Notifications</a></li>
</ul>



                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/subscription/2017/03/25/Gerenciando-subscriptions-com-In-App-Purchases/" data-toggle="tooltip" data-placement="top" title="Gerenciando subscriptions com In-App Purchases">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/bluetooth/2017/03/26/corebluetooth-na-pratica/" data-toggle="tooltip" data-placement="top" title="CoreBluetooth na Pr√°tica">Pr√≥ximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto ‚Äî Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
