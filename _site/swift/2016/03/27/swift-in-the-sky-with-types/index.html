<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento ‚Äî artigos, tutoriais e opini√£o.">

    <title>Swift In The Sky With Types - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/swift/2016/03/27/swift-in-the-sky-with-types/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Swift In The Sky With Types</h1>
                        
                        <h2 class="subheading">Ou apenas mais uma conversa sobre linguagens, compiladores, tipos e... Swift!</h2>
                        
                        <span class="meta">Postado por Matheus Albuquerque em 27/03/2016</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Swift In The Sky With Types&url=http://localhost:4000/swift/2016/03/27/swift-in-the-sky-with-types/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/swift/2016/03/27/swift-in-the-sky-with-types/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/swift/2016/03/27/swift-in-the-sky-with-types/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/swift/2016/03/27/swift-in-the-sky-with-types/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<blockquote>
  <p>Antes de tudo, algumas coisas a se levar em considera√ß√£o:</p>
</blockquote>

<blockquote>
  <ol>
    <li>Esse post √© baseado em experi√™ncias - e eu n√£o sou nenhum tipo de <em>dono da
verdade</em>: se voc√™ tem alguma opini√£o sobre isso - concordando, discordando,
complementando -, sinta-se livre para compartilh√°-la.</li>
    <li>Nem tudo nesse post √© sobre Swift: boa parte dele est√° relacionada a
experi√™ncias bem gerais relacionadas a projeto de linguagens de programa√ß√£o.</li>
    <li>H√° boatos que a experi√™ncia de ler o post √© enriquecida ouvindo-se o √°lbum
<a href="https://play.spotify.com/album/6QaVfG1pHYl1z15ZxkvVDW">Sgt. Pepper‚Äôs Lonely Hearts Club Band</a> ‚ò∫Ô∏è.</li>
  </ol>
</blockquote>

<h2 id="pr√≥logo">Pr√≥logo</h2>

<blockquote>
  <p>Algumas coisas que me levaram a pensar sobre <em>Sistemas de Tipos</em> - e a escrever
esse post‚Ä¶</p>
</blockquote>

<p>Eu, <a href="https://github.com/mabrasil">Matheus</a>, sou originalmente desenvolvedor
JavaScript. E, como em outras linguagens, tenho de lidar com alguns <em>probleminhas</em>.
Por exemplo, sua tipagem din√¢mica pode ser problem√°tica: JavaScript n√£o sabe
que tipo uma vari√°vel √© at√© que esta seja realmente atribu√≠da em execu√ß√£o - o
que significa que pode ser tarde demais, uma vez que voc√™ n√£o sabe se algum
erro de tipo estava em seu c√≥digo e quebrou antes de execut√°-lo.</p>

<p>Al√©m disso, n√≥s n√£o podemos contar com caras como o <code class="language-plaintext highlighter-rouge">instanceof</code> e o <code class="language-plaintext highlighter-rouge">typeof</code>:
eles n√£o funcionam de forma consistente - o que acaba nos mostrando que
verifica√ß√£o de tipos em JavaScript √© um problema - e voc√™ provavelmente tem que
fazer alguns <em>workarounds</em> para ajudar voc√™ a superar tal inconsist√™ncia - ou
usar caras como o <a href="http://www.typescriptlang.org/">TypeScript</a> ou o
<a href="http://flowtype.org/">Flow</a>.</p>

<p>O que tudo isso tem a ver com Swift? Bem, o contato com algumas inconsist√™ncias
relacionadas a tipos presenciadas em algumas linguagens - bem como sistemas de
tipos exemplares que pude experimentar em linguagens como
<a href="https://www.haskell.org/">Haskell</a>, <a href="https://ocaml.org/">OCaml</a> e
<a href="http://fsharp.org/">F#</a>- me fez ter sempre tal t√≥pico em mente ao come√ßar em
uma linguagem - e, h√° alguns meses, quando comecei a estudar a linguagem
da Apple, n√£o foi diferente.</p>

<h2 id="mas-antes">Mas Antes‚Ä¶</h2>

<p>‚Ä¶ de come√ßarmos a ver coisas espec√≠ficas de Swift relacionadas a seu
sistema de tipos, penso que seja interessante fazermos um <em>apanhado</em> de
alguns conceitos mais ‚Äúgerais‚Äù.</p>

<h3 id="dados">Dados?</h3>

<p><img src="/img/mabrasil/data.png" alt="Dados?" /></p>

<p>Esse √© um conceito bem primitivo - e que muitas vezes n√£o √© discutido e s√≥
aceito. Na <em>Filosofia</em>, temos uma defini√ß√£o parecida com isso:</p>

<blockquote>
  <p>Coisas conhecidas ou assumidas como <em>fatos</em>, tornando-se a <em>base do racioc√≠nio
ou c√°lculo</em>.</p>
</blockquote>

<p>Ao adentrarmos na <em>Computa√ß√£o</em>, come√ßamos a pensar de uma forma ou pouco
diferente sobre <em>dados</em> - ou melhor dizendo: um pouco mais <em>espec√≠fica</em> para o
contexto em que estamos - e encontramos defini√ß√µes como:</p>

<blockquote>
  <p><em>Quantidades</em>, <em>caracteres</em> ou <em>s√≠mbolos</em> dos quais opera√ß√µes s√£o executadas
por um computador, sendo armazenados e transmitidos na forma de sinais
el√©ctricos e gravados no suporte de grava√ß√£o magn√©tica, √≥ptica ou mec√¢nica.</p>
</blockquote>

<p>E assim, come√ßamos a pensar mais sobre dados como sendo um determinado peda√ßo de
informa√ß√£o - <em>textos</em>, <em>n√∫meros</em>, <em>listas</em>, <em>figuras</em> etc.: s√£o todos peda√ßos de
informa√ß√£o.</p>

<p>E, como podemos ler no famigerado
<a href="https://mitpress.mit.edu/sicp/full-text/book/book.html"><em>Livro do Mago</em></a>:</p>

<blockquote>
  <p>[‚Ä¶] <em>Processos computacionais</em> s√£o seres abstratos que habitam computadores.
√Ä medida que evoluem, os processos manipulam outros seres abstratos chamados
<strong>dados</strong>. A evolu√ß√£o de um processo √© dirigida por um padr√£o de regras chamado
<em>programa</em>. As pessoas criam programas para direcionar processos. [‚Ä¶]</p>
</blockquote>

<p>Dados s√£o uma das partes mais importantes da arte de programar.</p>

<p>E, particularmente, eu diria que a conversa come√ßa a ficar mais legal quando
pensamos sobre como essas informa√ß√µes s√£o passadas a um computador - afinal,
eles n√£o sabem o que um <em>n√∫mero</em> √©, ou o que o <em>infogr√°fico de seu documento</em>
√©, ou o que a <em>URL</em> da sua p√°gina √© - e assim por diante.</p>

<p>Ent√£o chegamos a - j√° esperada - conclus√£o de que, se queremos passar a nosso
computador qualquer um desses <em>peda√ßos de informa√ß√£o</em>, precisamos saber
represent√°-los de alguma maneira que o computador entenda.</p>

<p>Guarda bem essa palavra: <strong>representa√ß√£o</strong> - pois ela nos leva ao pr√≥ximo
t√≥pico.</p>

<h3 id="tipos-de-dados">Tipos de Dados?</h3>

<p><img src="/img/mabrasil/data-types.png" alt="Tipos de Dados?" /></p>

<blockquote>
  <p><strong>tl;dr</strong>: Uma representa√ß√£o espec√≠fica de algum(ns) dado(s).</p>
</blockquote>

<p>Basicamente, essa galera aqui te diz como interagir com um determinado
<em>peda√ßo de informa√ß√£o</em> e ainda pode dizer como essa informa√ß√£o (dado) √©
representada por meio de outras informa√ß√µes mais primitivas - ou <em>vice-versa</em>:
como interpretar dados mais primitivos a partir de um determinado tipo de dados.</p>

<p>Se o ato de programar consiste em gerenciar processos de tal forma que eles
possam manipular dados, <strong>√© de import√¢ncia crucial que tais processos manipulem
dados de forma eficiente e correta</strong>.</p>

<p>Seguindo o racioc√≠nio, modelar dados de forma que estes possam ser <em>manipulados
de forma eficiente e correta</em> √© uma parte essencial de todas as tarefas de um
programador - e os tipos de dados s√£o essenciais para tal modelagem - assim,
temos neles a <strong>important√≠ssima</strong> tarefa de garantir que as intera√ß√µes
com um determinado <em>peda√ßo de informa√ß√£o</em> estejam sempre corretas.</p>

<p>A prop√≥sito, guarde bem, tamb√©m, essa palavra: <strong>correto</strong> - pois ela ainda ser√° bem
discutida mais a frente.</p>

<h3 id="sistemas-de-tipos">Sistemas de Tipos?</h3>

<p><img src="/img/mabrasil/type-system.png" alt="Sistemas de Tipos?" /></p>

<blockquote>
  <p><strong>tl;dr</strong>: Sistemas do tipo s√£o, em sua ess√™ncia, estruturas de an√°lise de
programas.</p>
</blockquote>

<p>Soa confuso? √â, realmente pode ser <em>bem</em> confuso.</p>

<p>Que tal pedirmos ajuda aos universit√°rios?</p>

<p>Bem, <a href="http://www.cis.upenn.edu/~bcpierce/">Benjamin Pierce</a>, em seu livro
<a href="https://www.cis.upenn.edu/~bcpierce/tapl/">Types and Programming Languages</a>,
nos conta que:</p>

<blockquote>
  <p>Um sistema de tipos √© um m√©todo sint√°tico trat√°vel para provar o n√£o
cumprimento de certos comportamentos do programa atrav√©s da classifica√ß√£o de
<em>express√µes</em> de acordo com os tipos de valores que estas computam.</p>
</blockquote>

<p>Eu diria que uma das chaves para entendermos o t√≥pico √© o trecho:</p>

<blockquote>
  <p>[‚Ä¶] provar o n√£o cumprimento de certos comportamentos do programa [‚Ä¶].</p>
</blockquote>

<p>a partir do qual podemos ver que, para todo sistema de tipos espec√≠fico,
haver√° uma lista de coisas que este visa a provar - do que exatamente consiste
tal prova √© deixado em aberto.</p>

<p>Uma forma pr√°tica de tentar enxergar isso √© pensar em simples express√µes. Por
exemplo, uma vez que o verificador de tipos pega a express√£o <code class="language-plaintext highlighter-rouge">1 + 2</code>, este pode
‚Äúolhar‚Äù para o <code class="language-plaintext highlighter-rouge">1</code> e inferir que se trata de um inteiro, olhar para o <code class="language-plaintext highlighter-rouge">2</code> - e
tamb√©m inferir que este √© um inteiro - e, em seguida, olhar para o operador
<code class="language-plaintext highlighter-rouge">+</code>, e saber que, quando <code class="language-plaintext highlighter-rouge">+</code> √© aplicada a dois inteiros, o resultado √© um
n√∫mero inteiro - e a√≠ temos nossa prova.</p>

<h3 id="correctness-by-design"><em>Correctness-by-Design</em></h3>

<p><img src="/img/mabrasil/correctness-by-design.png" alt="Correctness-by-Design" /></p>

<p>Esse conceito aqui tamb√©m √© sempre legal de se pensar sobre, garanto.</p>

<p>Um dos principais objetivos de uma linguagem de programa√ß√£o deve ser a
capacidade de orientar o programador a uma abordagem de <em>Correctness-by-Design</em>.
Isto √©, um programa que √© v√°lido nesta linguagem, tamb√©m deve ser um programa
que funciona como o esperado - ou seja: o sistema simplesmente n√£o poder√° chegar
a um estado inv√°lido; um estado que n√£o cumpre os requisitos de tal programa.</p>

<p>Para tanto, a linguagem deve fazer um esfor√ßo de rejeitar programas que possam
estar errados - ou, ao menos, torn√°-los mais dif√≠ceis de escrever. Assim,
voc√™ literalmente n√£o pode escrever c√≥digo incorreto pelo simples fato de o
compilador n√£o deixar.</p>

<h3 id="correctness-by-design--sistemas-de-tipos"><em>Correctness-by-Design</em> &amp; Sistemas de Tipos</h3>

<p><img src="/img/mabrasil/correctness-by-design-and-type-systems.png" alt="Correctness-by-Design &amp; Sistemas de Tipos" /></p>

<p>Agora que j√° temos uma ideia geral em torno de sistemas de tipos e de como
linguagens devem ser projetadas de modo a naturalmente evitar que programas
feitos nestas atinjam estados inv√°lidos, voc√™ deve estar se perguntando: qual √©
a exata rela√ß√£o entre ambos?</p>

<p>Sinceramente, eu gostaria de ter uma rela√ß√£o pr√≥pria j√° estabelecida t√£o
expressiva quanto a feita pelo ilustre pesquisador
<a href="http://lucacardelli.name/">Luca Cardelli</a>, da
<a href="http://research.microsoft.com/en-us/default.aspx">Microsoft Research</a>:</p>

<blockquote>
  <p>O prop√≥sito fundamental de um sistema de tipo √© <strong>evitar a ocorr√™ncia de
erros durante a execu√ß√£o de um programa</strong>.</p>
</blockquote>

<p>Ainda subjetivo? Ele vai al√©m:</p>

<blockquote>
  <p>Sistemas de tipos fornecem ferramentas conceituais para julgar a adequa√ß√£o
de aspectos importantes de defini√ß√µes da linguagem. Descri√ß√µes de linguagem
informais muitas vezes n√£o conseguem especificar a estrutura de tipos de uma
linguagem com detalhes suficientes de maneira a evitar a aplica√ß√£o equ√≠voca.
Muitas vezes, acontece que diferentes compiladores para a mesma linguagem
implementam sistemas de tipo ligeiramente diferentes. Al√©m disso, muitas
defini√ß√µes de linguagens se mostraram ser defeituosas no quesito tipos,
permitindo que um programa quebre - mesmo sendo considerado aceit√°vel por um
<em>typechecker</em>.</p>
</blockquote>

<p>Assim, vemos no nosso sistema de tipos a figura respons√°vel por <em>‚Äújulgar a
adequa√ß√£o de aspectos importantes das defini√ß√µes de uma linguagem‚Äù</em>, de forma
a <em>‚Äúevitar a escrita de c√≥digo incorreto pelo simples fato de o compilador n√£o
deixar‚Äù</em>.</p>

<h3 id="o-que-temos-por-a√≠">O Que Temos Por A√≠?</h3>

<p><img src="/img/mabrasil/what-we-have.png" alt="O Que Temos Por A√≠?" /></p>

<p>Esta se√ß√£o serve mais para contextualizar Swift entre outras linguagens antes
de falarmos especificamente desta.</p>

<p>As linguagens se dividem em duas categorias: <strong>tipadas</strong> e <strong>n√£o-tipadas</strong> - ou
<em>unitipadas</em>.</p>

<blockquote>
  <p><em>B√¥nus</em>: At√© a forma como pensamos na defini√ß√£o de tipos pode variar dentro
desse espectro, mas isso √© tema para outras discuss√µes - e vamos manter a nossa
defini√ß√£o alcan√ßada nas se√ß√µes anteriores.</p>
</blockquote>

<p>Na primeira, temos representantes como <em>Haskell</em>, <em>OCaml</em>, <em>F#</em>, entre muitas
outras, incluindo nossa querida <em>Swift</em>. Nestas, as express√µes t√™m tipos
diferentes, e quando se combina uma express√£o particular, os tipos devem estar
coerentes - assim, se voc√™ tem uma express√£o <code class="language-plaintext highlighter-rouge">Int</code> + <code class="language-plaintext highlighter-rouge">Int</code>, n√£o √© poss√≠vel
escrever <code class="language-plaintext highlighter-rouge">"Swift"</code> + <code class="language-plaintext highlighter-rouge">1</code>, porque <code class="language-plaintext highlighter-rouge">"Swift"</code> n√£o tem o tipo <code class="language-plaintext highlighter-rouge">Int</code>.</p>

<p>Na segunda, tamb√©m temos representantes de peso, como: <em>Clojure</em>, <em>Erlang</em> e
<em>Scheme</em>. Nestas, todas as express√µes t√™m o mesmo tipo, portanto, n√£o h√°
restri√ß√µes em como as express√µes podem ser combinadas - assim, a mesma express√£o
do exemplo anterior seria um constru√ß√£o v√°lida, pois seria uma express√£o do tipo
<code class="language-plaintext highlighter-rouge">Object</code> + <code class="language-plaintext highlighter-rouge">Object</code> - ou algo assim.</p>

<p>Atualmente - at√© onde eu sei - exemplos que temos de mais poderosos e
expressivos em rela√ß√£o a sistemas de tipos s√£o os de
<a href="http://wiki.portal.chalmers.se/agda/pmwiki.php">Agda</a>,
<a href="http://www.idris-lang.org/">Idris</a> e <a href="https://coq.inria.fr/">Coq</a>, que possuem
tipagem dependente e indutiva - programar nestas √© realmente uma experi√™ncia
incr√≠vel de intera√ß√£o com seu <em>typechecker</em>.</p>

<p>Um pouco mais abaixo - mas ainda proporcionando lindezas relacionadas a tipos -
temos aquelas que se baseiam em varia√ß√µes do modelo <em>Hindley‚ÄìMilner</em> - do qual
voc√™ pode achar uma explica√ß√£o bem interessante <a href="http://akgupta.ca/blog/2013/05/14/so-you-still-dont-understand-hindley-milner/">aqui</a> -, como <em>Haskell</em>, <em>ML</em>, <em>OCaml</em>,
<a href="https://www.rust-lang.org/">Rust</a>, <a href="http://scala-lang.org/">Scala</a> e‚Ä¶
<em>Swift</em>.</p>

<p>Ainda sobre classifica√ß√µes, temos que <em>Swift</em> √©:</p>

<ul>
  <li><strong>Estaticamente Tipada</strong>: Ou seja, todas as suas <em>vari√°veis</em>, <em>constantes</em>,
<em>fun√ß√µes</em> etc. devem ter seus tipos declarados - ou inferidos, como veremos mais
adiante - antecipadamente. Ent√£o o compilador, ao compilar seu programa, usa
essas declara√ß√µes de tipo para verificar se n√£o h√° erros. Se houver um erro de
tipo, o programa n√£o ser√° compilado.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="nv">x</span><span class="p">:</span> <span class="kt">Int</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">x</span> <span class="o">=</span> <span class="s">"Swift"</span> <span class="c1">// =&gt; Aqui temos um erro</span>
</code></pre></div></div>

<ul>
  <li><strong>Fortemente Tipada</strong>: O que nos diz que, sempre que voc√™ usar uma vari√°vel,
ou passar algo como um argumento de uma fun√ß√£o, Swift ir√° verificar, em tempo
de compila√ß√£o, se este √© do tipo correto - assim voc√™ n√£o pode, por exemplo,
passar um <code class="language-plaintext highlighter-rouge">Float</code> para uma fun√ß√£o que espera um <code class="language-plaintext highlighter-rouge">Int</code>.</li>
</ul>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Uma simples fun√ß√£o que retorna o fatorial de um valor.</span>

<span class="c1">// Pela anota√ß√£o de tipo, temos que fatorial recebe um `Int` e o mapeia para</span>
<span class="c1">// um `Int`.</span>

<span class="kd">func</span> <span class="nf">fatorial</span><span class="p">(</span><span class="nv">n</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">n</span> <span class="o">*</span> <span class="nf">fatorial</span><span class="p">(</span><span class="n">n</span><span class="err">‚Ää‚Äî‚Ää</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>
<span class="c1">// Chamando nossa fun√ß√£o com um `Int`, teremos um `Int` de retorno.</span>
<span class="nf">fatorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c1">// =&gt; 6</span>

<span class="c1">// Chamando nossa fun√ß√£o com um `Float`, teremos um erro.</span>
<span class="nf">fatorial</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="c1">// =&gt; Erro.</span>
</code></pre></div></div>

<p>E agora‚Ä¶</p>

<h2 id="vamos-falar-de-swift">Vamos Falar de Swift?</h2>

<blockquote>
  <p><em>Ufa, finalmente! Um post intitulado ‚ÄúSwift In The Sky With Types‚Äù e at√©
agora nada demais sobre Swift?!</em></p>
</blockquote>

<p>Agora, gostaria de levantar algumas coisas que v√£o al√©m do que vimos na se√ß√£o
anterior.</p>

<h3 id="type-safety"><em>Type-Safety</em></h3>

<p><img src="/img/mabrasil/type-safety.png" alt="Type-Safety" /></p>

<p>Como podemos encontrar na pr√≥pria <a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html#//apple_ref/doc/uid/TP40014097-CH5-ID309">documenta√ß√£o provida pela Apple</a>:</p>

<blockquote>
  <p>Swift √© uma linguagem <em>type-safe</em>, o que significa que a linguagem ajuda voc√™ a
ser claro sobre os tipos dos valores com os quais seu c√≥digo pode trabalhar. Se
parte do seu c√≥digo espera uma <code class="language-plaintext highlighter-rouge">String</code>, a seguran√ßa de tipos impede que voc√™
possa, por engano, passar um <code class="language-plaintext highlighter-rouge">Int</code>.</p>
</blockquote>

<p>Assim, sabemos que <strong>todas</strong> as vari√°veis t√™m um tipo declarado e <strong>todas</strong> as
fun√ß√µes/m√©todos t√™m assinaturas de tipo que declaram os tipos de seus argumentos
e retornos. E por fim, o nosso amigo compilador verifica se todos os seus tipos
est√£o coerentes e n√£o compila seu programa caso n√£o estejam - erros em tempo de
compila√ß√£o s√£o üíñ.</p>

<blockquote>
  <p><em>B√¥nus</em>: Swift nos permite definir v√°rias ‚Äúvers√µes‚Äù de uma mesma fun√ß√£o, s√≥
que com diferentes assinaturas de tipos - e a ‚Äúvers√£o‚Äù que ser√° chamada
ser√° aquela cujos argumentos forem compat√≠veis com a assinatura de tipo -
inclusive, h√° um monte de coisas legais relacionadas √† Swift e seu suporte a
polimorfismo Ad-hoc.</p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1">// Uma simples fun√ß√£o que retorna o fatorial de um valor.</span>

<span class="c1">// Pela anota√ß√£o de tipo, temos que fatorial recebe um `Int` e o mapeia para</span>
<span class="c1">// um `Int`.</span>

<span class="kd">func</span> <span class="nf">fatorial</span><span class="p">(</span><span class="nv">n</span><span class="p">:</span> <span class="kt">Int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">?</span> <span class="mi">1</span> <span class="p">:</span> <span class="n">n</span> <span class="o">*</span> <span class="nf">fatorial</span><span class="p">(</span><span class="n">n</span><span class="err">‚Ää‚Äî‚Ää</span><span class="mi">1</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Agora, pela anota√ß√£o de tipo, temos que fatorial recebe um `Float` e</span>
<span class="c1">// mapeia este para um `Float`.</span>

<span class="kd">func</span> <span class="nf">fatorial</span><span class="p">(</span><span class="nv">n</span><span class="p">:</span> <span class="kt">Float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Float</span> <span class="p">{</span>
  <span class="k">return</span> <span class="n">n</span> <span class="o">==</span> <span class="mf">0.0</span> <span class="p">?</span> <span class="mf">1.0</span> <span class="p">:</span> <span class="n">n</span> <span class="o">*</span> <span class="nf">fatorial</span><span class="p">(</span><span class="n">n</span><span class="err">‚Ää‚Äî‚Ää</span><span class="mf">1.0</span><span class="p">)</span>
<span class="p">}</span>

<span class="c1">// Chamando nossa fun√ß√£o com um `Int`, teremos um `Int` de retorno.</span>
<span class="nf">fatorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>   <span class="c1">// =&gt; 6</span>

<span class="c1">// Chamando nossa fun√ß√£o com um `Float`, teremos um `Float` de retorno.</span>
<span class="nf">fatorial</span><span class="p">(</span><span class="mf">3.0</span><span class="p">)</span> <span class="c1">// =&gt; 6.0</span>
</code></pre></div></div>

<h3 id="type-inference"><em>Type Inference</em></h3>

<p><img src="/img/mabrasil/type-inference.png" alt="Type Inference" /></p>

<p>Se voc√™ √© daqueles que se assusta com a possibilidade de ter que declarar tipo
de cada vari√°vel do seu c√≥digo, relaxe! Swift usa a infer√™ncia de tipos
para - <strike>adivinha?</strike> - inferir quais os tipos suas vari√°veis t√™m.
Caso queira, voc√™ pode declarar explicitamente o tipo de suas vari√°veis, mas,
na pr√°tica, muitas vezes voc√™ n√£o precisa: Swift ir√° inferir o tipo de uma
<code class="language-plaintext highlighter-rouge">var</code> se voc√™ atribuir a ela um valor inicial.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Aqui, inicializamos uma vari√°vel `x`, dando a esta o valor `1`. Como</span>
<span class="c1">// fornecemos um valor inicial, n√£o precisamos declarar explicitamente o tipo</span>
<span class="c1">// de `x`: Swift ir√° inferir que esta se trata de um `Int`.</span>
<span class="k">var</span> <span class="nv">x</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1">// Desta vez, declaramos uma vari√°vel, mas sem atribuir valor a esta - assim,</span>
<span class="c1">// Swift n√£o pode inferir seu tipo e precisamos definir este explicitamente.</span>
<span class="c1">// Logo ap√≥s a declara√ß√£o, atribu√≠mos a ela o valor `2` - e caso atribu√≠ssemos</span>
<span class="c1">// um valor de tipo n√£o coerente com a declara√ß√£o, ter√≠amos um erro do compilador.</span>
<span class="k">var</span> <span class="nv">y</span><span class="p">:</span><span class="kt">Int</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div></div>

<h3 id="generics"><em>Generics</em></h3>

<p><img src="/img/mabrasil/generics.png" alt="Generics" /></p>

<p>Os conhecidos <em>Generics</em> nos permitem declarar uma vari√°vel que, na execu√ß√£o,
pode ser atribu√≠do a um conjunto de tipos definidos por n√≥s.</p>

<p>Em Swift, um <em>array</em> pode conter dados de qualquer tipo: ao criarmos um <em>array</em>
de <code class="language-plaintext highlighter-rouge">Int</code>s, <code class="language-plaintext highlighter-rouge">Float</code>s ou <code class="language-plaintext highlighter-rouge">String</code>s, por exemplo, o tipo dos valores que este vai
carregar √© definido quando o mesmo √© declarado - e assim, temos neles um bom
exemplo do uso de <em>Generics</em>.</p>

<p>O uso destes come√ßa com <strong>fun√ß√µes gen√©ricas</strong>, como uma simples fun√ß√£o para
imprimir elementos de um array:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Fun√ß√µes gen√©ricas usam placeholders ao inv√©s de um tipo real, como `String`,</span>
<span class="c1">// `Int` ou `Float`. Em nossa fun√ß√£o, o placeholder √© `T` - mas poderia ser</span>
<span class="c1">// qualquer outro: `T` √© "apenas" conven√ß√£o.</span>

<span class="c1">// O uso do placeholder n√£o indica que a fun√ß√£o aceita um tipo `T` mas sim que</span>
<span class="c1">// `T` ser√° substitu√≠do por um tipo real que √© determinada quando a fun√ß√£o √©</span>
<span class="c1">// chamada.</span>

<span class="kd">func</span> <span class="n">imprimeElementos</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">a</span><span class="p">:</span> <span class="p">[</span><span class="kt">T</span><span class="p">])</span> <span class="p">{</span>
    <span class="k">for</span> <span class="n">elemento</span> <span class="k">in</span> <span class="n">a</span> <span class="p">{</span>
        <span class="nf">println</span><span class="p">(</span><span class="n">elemento</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>E a brincadeira com estas pode ir al√©m: poder√≠amos, por exemplo, ter algo do tipo:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="n">minhaFuncao</span><span class="o">&lt;</span><span class="kt">T</span><span class="p">,</span> <span class="kt">U</span><span class="o">&gt;</span><span class="p">(</span><span class="nv">a</span><span class="p">:</span> <span class="kt">T</span><span class="p">,</span> <span class="nv">b</span><span class="p">:</span> <span class="kt">U</span><span class="p">)</span> <span class="p">{}</span>
</code></pre></div></div>

<p>Onde especificamos mais de um <em>Generic</em>.</p>

<p>Por√©m, a divers√£o n√£o para nas fun√ß√µes gen√©ricas: temos os tipos gen√©ricos!
Estes s√£o, basicamente, <em>classes</em>, <em>enumerations</em> e <em>structs</em> que trabalham com
qualquer tipo - se voc√™ se lembrou de <em>array</em>s e <em>dictionaries</em>, voc√™ pegou a
ideia.</p>

<p>Assim, podemos ter coisas como:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Um exemplo de necessidade comum, por exemplo, √© obter um valor rand√¥mico de</span>
<span class="c1">// uma cole√ß√£o - e podemos implementar isso com Generics!</span>

<span class="c1">// Temos uma estrutura que √© gen√©rica sobre o tipo `T`.</span>
<span class="kd">struct</span> <span class="kt">MinhaColecao</span><span class="o">&lt;</span><span class="kt">T</span><span class="o">&gt;</span> <span class="p">{</span>

    <span class="c1">// Temos uma propriedade, um array do tipo T para armazenar o conjunto de</span>
    <span class="c1">// dados passados durante a inicializa√ß√£o.</span>
    <span class="k">let</span> <span class="nv">itens</span><span class="p">:</span> <span class="p">[</span><span class="kt">T</span><span class="p">]</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">itens</span><span class="p">:</span> <span class="p">[</span><span class="kt">T</span><span class="p">])</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">itens</span> <span class="o">=</span> <span class="n">itens</span>
    <span class="p">}</span>

    <span class="c1">// E, por fim, temos uma fun√ß√£o gen√©rica que cuida do resto :)</span>
    <span class="kd">func</span> <span class="nf">geraAleatorio</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">T</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">indice</span> <span class="o">=</span> <span class="kt">Int</span><span class="p">(</span><span class="nf">arc4random_uniform</span><span class="p">(</span><span class="kt">UInt32</span><span class="p">(</span><span class="n">itens</span><span class="o">.</span><span class="n">count</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">itens</span><span class="p">[</span><span class="n">indice</span><span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>E, ao testarmos:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">teste</span> <span class="o">=</span> <span class="kt">MinhaColecao</span><span class="p">(</span><span class="nv">itens</span><span class="p">:</span> <span class="p">[</span><span class="s">"s"</span><span class="p">,</span> <span class="s">"w"</span><span class="p">,</span> <span class="s">"i"</span><span class="p">,</span> <span class="s">"f"</span><span class="p">,</span> <span class="s">"t"</span><span class="p">])</span>
<span class="n">teste</span><span class="o">.</span><span class="nf">geraAleatorio</span><span class="p">()</span> <span class="c1">// =&gt; "f"</span>
</code></pre></div></div>

<h2 id="concluindo">Concluindo</h2>

<blockquote>
  <p>Falou quase nada de Swift!</p>
</blockquote>

<p>√â‚Ä¶ Verdade! Perto do que se tem a ser dito, n√£o foi dito quase nada de nada.
Cada um desses t√≥picos sobre Swift - at√© os mais primitivos -, juntamente com
alguns que n√£o explorei para evitar text√£o - como <em>Phantom Types</em>,
<em>Typeclasses</em> etc. - renderia/mereceria um post ou talk sobre. E com os t√≥picos
mais te√≥ricos discutidos no post n√£o √© muito diferente - de fato, √© sim: estes
√© que renderiam/mereceriam mais posts e talks para serem discutidos!</p>

<p>Na verdade, o objetivo maior do post √© apenas levantar cada um destes t√≥picos em
sua mente - e o fazer pensar e buscar mais sobre eles.</p>

<blockquote>
  <p>Eu realmente ganho algo?</p>
</blockquote>

<p>Voc√™ pode ainda estar se perguntando se todas estas palavras relacionadas √†
teoria dos tipos - e outras √°reas de estudo comumente associadas a projeto e
implementa√ß√£o de linguagem - que soam algo muito <em>apenas da Academia</em> realmente
afetam a forma como voc√™ escreve aplica√ß√µes do mundo real; para resolver
problemas reais.</p>

<p>Bem, eu confesso que, quando comecei a interessar mais por esse assunto, tamb√©m
tinha muitos pensamentos assim - algo do tipo: <em>‚ÄúPoxa, at√© ontem eu escrevia
c√≥digo que funcionava e n√£o entendia nada disso! N√£o vai ser agora que vou
precisar‚Äù</em>.</p>

<p>O que eu n√£o me ligava muito era que a formo como eu modelo meus dados afeta -
e muito! - a forma como eu interajo com estes. E:</p>

<ul>
  <li>
    <p>Poder deduzir o que uma fun√ß√£o faz a partir de sua assinatura de tipo - algo
inclusive muito √∫til para tornar o c√≥digo mais leg√≠vel e compreens√≠vel -;</p>
  </li>
  <li>
    <p>Ter o processo de refatora√ß√£o facilitado, uma vez que conto com um monte de
erros de compila√ß√£o para me dizer onde as coisas come√ßaram a dar errado;</p>
  </li>
  <li>
    <p>Ter a garantia que as rela√ß√µes entre meus dados est√£o ocorrendo da forma que
deveriam.</p>
  </li>
</ul>

<p>S√£o etapas que, diria eu, s√£o necess√°rias para se atingir a coer√™ncia requerida
para se interagir corretamente com uma informa√ß√£o - e isso, colega, causa
grande impacto no seu software final.</p>

<blockquote>
  <p>Poxa, agora o compilador ser√° meu inimigo?</p>
</blockquote>

<p><strong>tl;dr</strong>: De forma alguma, galera.</p>

<p>A priori, pode soar <strike>muito chato</strike> doloroso travar uma <em>‚Äúluta‚Äù</em>
contra um <em>typechecker</em> apenas para ver um programa que voc√™ <strong>tem certeza de
que est√° correto</strong> compilado. Alguns chegam at√© a ver como uma p√©ssima
caracter√≠stica da linguagem se pensarmos em um conceito de <em>bom</em> para uma lang
definido atrav√©s da m√©trica ‚Äúser <em>developer-friendly</em>‚Äù.</p>

<p>Por√©m, um ponto que eu penso ser interessante de se discutir √© o fato de que a
no√ß√£o t√©cnica de <em>melhor</em> envolve aspectos - estes indo muito al√©m do sistema
de tipos, como: seu modelo de execu√ß√£o, o qu√£o segura esta √©, maneiras que se
usa pra obter melhor expressividade - que nem sempre, <strong>√† primeira vista</strong>, se
alinham com a felicidade do desenvolvedor.</p>

<p>Particularmente, o tempo me mostrou que, ao programar em uma linguagem que me
fa√ßa pensar cuidadosamente sobre tipos, acabo chegando a um c√≥digo melhor
projetado, mais f√°cil de manter, que falha mais r√°pido - caso este haja de
falhar, claro -, melhor documentado etc. Assim, passei a ver o compilador n√£o
como um inimigo, mas como uma ferramenta que me guia de uma bela forma a
solu√ß√£o para o meu problema - atrav√©s de tipos.</p>

<p>E tudo isso faz voc√™ se sentir bem mais confiante sobre seu pr√≥prio c√≥digo - e
isso √© t√£o divertido quanto ouvir a faixa <em>Lucy In The Sky With Diamonds</em> ‚ò∫Ô∏è.</p>

<h2 id="refer√™ncias">Refer√™ncias</h2>

<p>Aqui ficam apenas alguns posts, livros, v√≠deos etc. nos quais me baseei ao
longo da escrita deste post - e que eu acho que mereceriam um tempo da aten√ß√£o
de voc√™s.</p>

<ul>
  <li><a href="https://www.youtube.com/watch?v=52VsgyexS8Q&amp;feature=youtu.be"><strong>Hole-driven Haskell</strong></a>
    <blockquote>
      <p><em>Screencast</em> por <a href="http://matthew.brecknell.net/">Matthew Brecknell</a>.</p>
    </blockquote>
  </li>
  <li><a href="https://www.youtube.com/watch?v=gVXt1RG_yN0"><strong>May Your Data Ever Be Coherent</strong></a>
    <blockquote>
      <p><em>Talk</em> por <a href="http://www.codecommit.com/blog/">Daniel Spiewak</a>.</p>
    </blockquote>
  </li>
  <li><a href="http://lucacardelli.name/papers/onunderstanding.a4.pdf"><strong>On Understanding Types,Data Abstraction, and Polymorphism</strong></a>
    <blockquote>
      <p>Artigo por <a href="http://lucacardelli.name/">Luca Cardelli</a>.</p>
    </blockquote>
  </li>
  <li><a href="https://mitpress.mit.edu/sicp/full-text/book/book.html"><strong>Structure and Interpretation of Computer Programs</strong></a>
    <blockquote>
      <p>O famoso <em>Livro do Mago</em> √© sempre uma refer√™ncia!</p>
    </blockquote>
  </li>
  <li><a href="https://developer.apple.com/library/ios/documentation/Swift/Conceptual/Swift_Programming_Language/TheBasics.html"><strong>The Swift Programming Language (Swift 2.2) - The Basics</strong></a>
    <blockquote>
      <p>Documenta√ß√£o oficial provida pela Apple.</p>
    </blockquote>
  </li>
  <li><a href="http://lucacardelli.name/Papers/TypeSystems.pdf"><strong>Type Systems</strong></a>
    <blockquote>
      <p>Artigo por <a href="http://lucacardelli.name/">Luca Cardelli</a>.</p>
    </blockquote>
  </li>
  <li><a href="https://www.cis.upenn.edu/~bcpierce/tapl/"><strong>Types and Programming Languages</strong></a>
    <blockquote>
      <p>Livro de <a href="http://www.cis.upenn.edu/~bcpierce/">Benjamin Pierce</a>.</p>
    </blockquote>
  </li>
</ul>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/extensions/2016/03/26/app-extension-today-widget/" data-toggle="tooltip" data-placement="top" title="App Extension - Today Widget">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/reactive/2016/03/28/Reactivecocoa-+-MVVM/" data-toggle="tooltip" data-placement="top" title="ReactiveCocoa + MVVM">Pr√≥ximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto ‚Äî Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
