<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento — artigos, tutoriais e opinião.">

    <title>Vamos falar de Xcode - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/xcode/2016/03/09/vamos-falar-de-xcode/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Vamos falar de Xcode</h1>
                        
                        <span class="meta">Postado por Tales Pinheiro em 09/03/2016</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Vamos falar de Xcode&url=http://localhost:4000/xcode/2016/03/09/vamos-falar-de-xcode/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/xcode/2016/03/09/vamos-falar-de-xcode/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/xcode/2016/03/09/vamos-falar-de-xcode/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/xcode/2016/03/09/vamos-falar-de-xcode/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<blockquote>
  <p>Tales Pinheiro (<a href="https://twitter.com/talesp" target="_blank">@talesp</a>) é mestre em computação pelo IME-USP, trabalhou por 8 anos com backend bancário programando principalmente em C, quando em 2007 (antes do anúncio do primeiro iPhone!) resolveu aprender Objective-C, e tem escrito Swift há pouco mais de 6 meses.</p>
</blockquote>

<h1 id="vamos-falar-de-xcode">Vamos falar de Xcode</h1>

<p>Algum tempo atrás apresentei no CocoaHeads SP a palestra “Design de Arcabouços: definindo uma arquitetura de fluxo de trabalho para o desenvolvimento ágil de múltiplos projetos”. Nela falei um pouco sobre como usar o Xcode (e algumas técnicas/ferramentas adicionais) de forma eficiente para projetos complexos, mais ou menos o que o Hector Zarate, engenheiro do Spotify, apresentou na palestra <a href="https://www.youtube.com/watch?v=DWw1ankfqO0&amp;list=PLdr22uU_wISpW6XI1J0S7Lp-X8Km-HaQW&amp;index=14">iOS at Spotify: From Plan to Done</a> que assisti quando fui na UIKonf - apesar da palestra dele ser menos técnica.</p>

<p>Mas o assunto é extenso, e o Xcode é uma ferramenta complexa e complicada, então resolvi estender e destrinchar um pouco mais o assunto. Vou falar então de forma um pouco mais detalhada sobre os tópicos a seguir:</p>

<ul>
  <li>Projetos</li>
  <li><em>Workspaces</em></li>
  <li><em>Build configurations</em></li>
  <li><em>Targets</em></li>
  <li><em>Build Phases</em></li>
  <li><em>Schemes</em></li>
</ul>

<h2 id="projetos">Projetos</h2>
<p>Em geral, a primeira coisa que fazemos quando vamos iniciar um novo aplicativo é criar um novo projeto. É ele que contém os arquivos com código fonte, esquemas de construção dos <em>targets</em>, configurações de compilação, entre outras coisas.</p>

<p><img src="/img/talesp/project.png" alt="" /></p>

<p>Ao criar um novo projeto no Xcode, é gerado um “arquivo <em>bundle</em>” no diretório raiz do projeto. Esse “arquivo”, que na verdade é um diretório especial que o Finder exibe como arquivo, tem extensão <em>xcodeproj</em>. Ao navegarmos dentro desse diretório especial, vemos a seguinte estrutura de diretórios (extraído <a href="https://gist.githubusercontent.com/adamgit/3786883/raw/81819edb27057d54239d96710620369bc7f7378a/.gitignore">daqui</a>):</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> /(root)/
   /(project-name).xcodeproj/
     project.pbxproj
     /project.xcworkspace/
       contents.xcworkspacedata
       /xcuserdata/
         /(your name)/xcuserdatad/
           UserInterfaceState.xcuserstate
     /xcshareddata/
       /xcschemes/
         (shared scheme name).xcscheme
     /xcuserdata/
       /(your name)/xcuserdatad/
         (private scheme).xcscheme
         xcschememanagement.plist
</code></pre></div></div>

<p>Vemos então que na raiz desse diretório temos o arquivo <em>project.pbxproj</em>, e os diretórios <em>project.xcworkspace</em>, <em>xcshareddata</em> e <em>xcuserdata</em>.</p>

<p>O arquivo <em>project.pbxproj</em> nada mais é que um arquivo <em>JSON</em>. Nele temos o nome/caminho dos arquivos de código fonte (<em>headers</em> e arquivos de implementação), <em>assets</em> do projeto, frameworks usados pelo aplicativo, estrutura hierárquica de grupos de arquivos dentro do projeto (a forma como você organiza os arquivos dentro do projeto), as configurações das <em>build phases</em>, configurações de <em>targets</em>, entre outras coisas. Basicamente tudo que você vê ao selecionar o projeto dentro do <em>Project Navigator</em> (exibido rapidamente com o atalho <code class="language-plaintext highlighter-rouge">⌘1</code>. Apesar de um pouco estranho, é relativamente fácil de entender esse arquivo, pois o próprio Xcode adiciona comentários descrevendo cada parte, como por exemplo:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="err">//</span><span class="w"> </span><span class="err">!$*UTF</span><span class="mi">8</span><span class="err">*$!</span><span class="w">
</span><span class="p">{</span><span class="w">
  </span><span class="err">archiveVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="err">;</span><span class="w">
  </span><span class="err">classes</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">}</span><span class="err">;</span><span class="w">
  </span><span class="err">objectVersion</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">46</span><span class="err">;</span><span class="w">
  </span><span class="err">objects</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">

</span><span class="err">/*</span><span class="w"> </span><span class="err">Begin</span><span class="w"> </span><span class="err">PBXBuildFile</span><span class="w"> </span><span class="err">section</span><span class="w"> </span><span class="err">*/</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">31</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">AppDelegate.swift</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Sources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">21</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">AppDelegate.swift</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">51</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">ViewController.swift</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Sources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">41</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">ViewController.swift</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">81</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">Main.storyboard</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Resources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">61</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">Main.storyboard</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">DA</span><span class="mi">1</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">Assets.xcassets</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Resources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">D</span><span class="mi">91</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">Assets.xcassets</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">DD</span><span class="mi">1</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">LaunchScreen.storyboard</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Resources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">DB</span><span class="mi">1</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">LaunchScreen.storyboard</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9E81</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">CatsTests.swift</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Sources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9E71</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">CatsTests.swift</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">F</span><span class="mi">31</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">CatsUITests.swift</span><span class="w"> </span><span class="err">in</span><span class="w"> </span><span class="err">Sources</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXBuildFile;</span><span class="w"> </span><span class="err">fileRef</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">F</span><span class="mi">21</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">CatsUITests.swift</span><span class="w"> </span><span class="err">*/;</span><span class="w"> </span><span class="p">}</span><span class="err">;</span><span class="w">
</span><span class="err">/*</span><span class="w"> </span><span class="err">End</span><span class="w"> </span><span class="err">PBXBuildFile</span><span class="w"> </span><span class="err">section</span><span class="w"> </span><span class="err">*/</span><span class="w">

</span><span class="err">/*</span><span class="w"> </span><span class="err">Begin</span><span class="w"> </span><span class="err">PBXContainerItemProxy</span><span class="w"> </span><span class="err">section</span><span class="w"> </span><span class="err">*/</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9E41</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">PBXContainerItemProxy</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXContainerItemProxy;</span><span class="w">
      </span><span class="err">containerPortal</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">C</span><span class="mi">71</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">Project</span><span class="w"> </span><span class="err">object</span><span class="w"> </span><span class="err">*/;</span><span class="w">
      </span><span class="err">proxyType</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="err">;</span><span class="w">
      </span><span class="err">remoteGlobalIDString</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">CE</span><span class="mi">1</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F;</span><span class="w">
      </span><span class="err">remoteInfo</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Cats;</span><span class="w">
    </span><span class="p">}</span><span class="err">;</span><span class="w">
    </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">EF</span><span class="mi">1</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">PBXContainerItemProxy</span><span class="w"> </span><span class="err">*/</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="err">isa</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">PBXContainerItemProxy;</span><span class="w">
      </span><span class="err">containerPortal</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">C</span><span class="mi">71</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F</span><span class="w"> </span><span class="err">/*</span><span class="w"> </span><span class="err">Project</span><span class="w"> </span><span class="err">object</span><span class="w"> </span><span class="err">*/;</span><span class="w">
      </span><span class="err">proxyType</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">1</span><span class="err">;</span><span class="w">
      </span><span class="err">remoteGlobalIDString</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="mi">02</span><span class="err">CEB</span><span class="mi">9</span><span class="err">CE</span><span class="mi">1</span><span class="err">B</span><span class="mi">6E8</span><span class="err">EDB</span><span class="mi">00488E8</span><span class="err">F;</span><span class="w">
      </span><span class="err">remoteInfo</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="err">Cats;</span><span class="w">
    </span><span class="p">}</span><span class="err">;</span><span class="w">
</span><span class="err">/*</span><span class="w"> </span><span class="err">End</span><span class="w"> </span><span class="err">PBXContainerItemProxy</span><span class="w"> </span><span class="err">section</span><span class="w"> </span><span class="err">*/</span><span class="w">

</span></code></pre></div></div>

<p>Como podemos ver, a maior parte do arquivo é tomada pela chave <em>objects</em>, que nada mais é do que um dicionário, com uma chave hexadecimal - usada para referenciar os objetos do projeto de outras partes - e um valor, que em minhas pesquisas indicam ser sempre um outro dicionário. Para facilitar o entendimento, o Xcode adiciona ainda comentário internos, como por exemplo, <code class="language-plaintext highlighter-rouge">/* AppDelegate.swift in Sources */</code>. Em geral não vamos editar esse arquivo na mão, mas entendê-lo pode facilitar bastante na hora de resolver um conflito de <em>merge</em> com o uso de sistemas de versionamento de arquivos como <em>git</em>.</p>

<p>Vamos voltar ao Xcode e a estrutura de diretórios. Podemos ver que mesmo ao criar um projeto simples (por exemplo, via <em>File-&gt;New Project</em>), temos dentro da pasta do projeto uma subpasta chamada <em>project.xcworkspace</em>. A seguir, descrevo os <em>workspaces</em> um pouco melhor.</p>

<h2 id="workspaces"><em>Workspaces</em></h2>

<p><em>Workspaces</em> mantêm a referência para projetos/subprojetos, <em>save states</em> (janelas e abas abertas, breakpoints do usuário, etc), localização do produto (<em>app</em>, biblioteca estática ou dinâmica, binários temporários) e o índice de símbolos (classes, métodos, funções, testes, etc), agrupando isso de forma a facilitar a organização de projetos inter-relacionados.</p>

<p>E como é o <em>workspace</em> que registra o índice de símbolos, indexando todos os projetos dentro dele, <em>code completion</em>, <em>Jump to definition</em> e outras funcionalidades sensíveis ao conteúdo funcionam de forma transparente entre os projetos. Então se você adiciona subprojetos, navegar entre eles é bastante facilitado. Com isso, até mesmo refatorar código é feito entre vários projetos de um mesmo <em>workspace</em>.</p>

<p>Por padrão, todos os projetos dentro de um mesmo <em>workspace</em> são construídos no mesmo diretório, chamado <em>workspace build directory</em>, e cada <em>worskpace</em> tem seu próprio diretório. E como todos os projetos são construídos nesse diretório, esses arquivos construídos são visíveis pelos projetos incluídos no <em>workspace</em>. O Xcode indexa esse diretório e tenta descobrir dependências implícitas. Assim, se um projeto de um aplicativo constrói também uma biblioteca como dependência direta, e esta tem um link para uma outra biblioteca - sendo que esta não faz parte do <em>workspace</em> - o Xcode consegue identificar a dependência implícita e compila também essa bilbioteca.</p>

<p>Mesmo que você não crie - explicitamente ou através do <em>cocoapods</em>, por exemplo - um <em>workspace</em>, é gerado um automaticamente e implicitamente para você dentro do diretório do projeto. O diretório <em>project.xcworkspace</em> é outro arquivo <em>bundle</em>, e ao analisar seu conteúdo, vemos o arquivo XML “contents.xcworkspacedata” e o arquivo “/(your name)/xcuserdatad/UserInterfaceState.xcuserstate”, que efetivamente contém os breakpoints, arquivos abertos, etc. O conteúdo do arquivo contents.xcworkspace é bastante simples, conforme podemos ver abaixo:</p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;Workspace</span>
   <span class="na">version =</span> <span class="s">"1.0"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;FileRef</span>
      <span class="na">location =</span> <span class="s">"group:MyApp/MyApp.xcodeproj"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;/FileRef&gt;</span>
   <span class="nt">&lt;FileRef</span>
      <span class="na">location =</span> <span class="s">"group:Pods/Pods.xcodeproj"</span><span class="nt">&gt;</span>
   <span class="nt">&lt;/FileRef&gt;</span>
<span class="nt">&lt;/Workspace&gt;</span>
</code></pre></div></div>

<p>Quando usamos o CocoaPods para gerenciamento de dependências, um <em>workspace</em> é criado, e nele é adicionado o seu projeto original, além de um novo projeto exclusivo para gerenciar as dependências.</p>

<h2 id="targets"><em>Targets</em></h2>

<p><img src="/img/talesp/project.png" alt="" /></p>

<p><em>Targets</em> especificam produtos a serem construídos (bibliotecas, apps, etc), e suas divisões mais “tradicionais” são <em>General</em>, <em>Info</em>, <em>Build Settings</em>, <em>Build Phases</em> (além das mais recentes <em>Capabilities</em>, <em>Resource Tags</em> e da pouco usada <em>Build Rules</em>). Um <em>target</em> especifica um produto, organizando um conjunto de arquivos de entrada, um conjunto de regras e ações a serem tomadas sobre esses arquivos a fim de gerar um produto - um aplicativo ou biblioteca, por exemplo - como saída. Um projeto pode conter mais de um target, podendo gerar (tomando as devidas precauções, como não usar APIs indisponíveis) por exemplo, uma biblioteca compilada para iOS e tvOS, compartilhando código do mesmo projeto em diferentes <em>targets</em>.</p>

<p>As configurações gerais de como gerar o produto estão disponíveis na aba <em>Build Settings</em>, e é organizada de forma hierárquica, podendo inclusive ser compartilhada entre projetos não relacionados (nem mesmo estando no mesmo <em>workspace</em>, através do uso de arquivos de <em>build configurations</em>. A figura abaixo mostra a visão combinada das <em>Build Settings</em>.</p>

<p><img src="/img/talesp/combined.png" alt="Combined Build Settings" /></p>

<p>Mas recentemente tive um <a href="https://github.com/CocoaPods/CocoaPods/issues/4928">problema com o CocoaPods</a>, e para facilitar a identificação de onde especificamente estava o problema, utilizei a visão categorizada, disponível no botão <em>Levels</em>, que pode ser exibida abaixo.</p>

<p><img src="/img/talesp/levels.png" alt="" /></p>

<p>Nesse exemplo podemos ver, da direita (nível hierárquico mais básico) para a esquerda (configuração final aceita como <em>Build Setting</em> a ser utilizada) os níveis <em>iOS Default</em>, <em>CocoaHeads</em> (primeiro as configurações do projeto, sendo aqui o nome do seu projeto), <em>CocoaHeads</em> (aqui as configurações do <em>target</em>) e <em>Resolved</em> (opção exibida quando <em>Combined</em> está selecionado). Quando o projeto usa CocoaPods (ou quando você adiciona manualmente), são adicionados arquivos de configuração, que adicionam um nível adicional, chamado <em>Config File</em>. Foi nesse item que encontrei o causador do meu problema, qual era o arquivo que o estava causando, me permitindo abrir a <em>issue</em> no repositório do CocoaPods.</p>

<h3 id="build-settings"><em>Build Settings</em></h3>
<p>Como vimos acima, uma das abas to <em>Target Editor</em> é a <em>Build Settings</em>, que lista todas essas configurações disponíveis, mas estudando um pouco mais, podemos ver que cada <em>build setting</em> é na verdade uma variável que contém uma informação ou configuração específica sobre o processo de construção do produto, como para quais arquiteturas o binário será compilado. Como vimos acima, podemos especificar a configuração no projeto ou sobrescrever para um <em>target</em> específico.</p>

<p>Para descobrir qual o nome da variável, basta selecionar a <em>build setting</em> desejada e abrir a aba <em>Quick Help</em> do <em>Attribute Inspector</em> (por exemplo, pressionando <code class="language-plaintext highlighter-rouge">⌥⌘2</code>), como pode ser visto abaixo (onde a opção <code class="language-plaintext highlighter-rouge">SUPPORTED_PLATFORMS</code> está selecionada).</p>

<p><img src="/img/talesp/quickhelp.png" alt="" /></p>

<p>Para uma lista das variáveis, valores disponíveis e valores padrão, consulte a página <a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html">Build Setting Reference</a>. Além disso, é possível criar configurações definidas por você, que podem ser usadas por sistemas de integração contínua, compilação via linha de comando e, em alguns casos, como macros de preprocessamento dentro do código (ou dentro de um arquivo de <em>build configuration</em>). Também é útil utilizar configurações condicionais, permitindo por exemplo linkar com versões diferentes de uma biblioteca caso esteja sendo construído para o dispositivo ou para o simulador: já precisei usar isso quando me forneceram duas biliotecas, uma compilada apenas para arquitetura <code class="language-plaintext highlighter-rouge">i386</code> (usada pelo simulador em processadores 32 bits. Macs mais novos usam arquitetura <code class="language-plaintext highlighter-rouge">x86_64</code>) e outro compilada para <code class="language-plaintext highlighter-rouge">armv6</code> e <code class="language-plaintext highlighter-rouge">armv7</code>.</p>

<p>Uma referência legal de como utilizar é a página <a href="https://robots.thoughtbot.com/xcode-build-settings-part-1-preprocessing">Xcode Build Settings Part 1: Preprocessing</a></p>

<h3 id="build-phases"><em>Build Phases</em></h3>

<p>As <em>build phases</em> são um pequeno conjunto de fases necessárias para a geração do seu produto. As mais comuns são:</p>

<ul>
  <li><em>Target Dependencies</em>: Depêndencias explícitas de outras bibliotecas. Caso seu projeto dependa de uma biblioteca não compilada por um projeto dentro da sua <em>workspace</em> (explícita ou a implícita, incluída dentro do <em>bundle</em> <code class="language-plaintext highlighter-rouge">xcodeproj</code>), você adiciona aqui a dependência.</li>
  <li><em>Compile Sources</em>: A lista de todos os arquivos de código fonte compilados para gerar seu produto. Podemos passar <em>flags</em> de compilação (a lista depende do compilador, mas para o clang a lista completa está <a href="http://clang.llvm.org/docs/UsersManual.html#command-line-options">aqui</a>). Durante a migração de projetos que não usavam <em>Automatic Reference Couting</em> era comum ir migrando o projeto aos poucos, e marcar arquivo por arquivo quais usavam ARC ou não. Além de ser possível tratar individualmente por arquivo, é possível tratar de forma global via <em>Build Setting</em>. Quando trabalho por mais tempo em um produto, gosto de ligar por exemplo as opções <code class="language-plaintext highlighter-rouge">-Weverything</code> e para a geração do binário final, <code class="language-plaintext highlighter-rouge">-Werror</code>. Assim tenho uma análise minuciosa do compilador, e todos os <em>warnings</em> são tratados como erro. Infelizmente em projetos mais curtos não é possível ter tanta garantia, pois a validação disso às vezes exige um tempo maior.</li>
  <li><em>Link binary with Libraries</em>: Caso alguém (ou alguma empresa) tenha lhe fornecido uma bilioteca pré-compilada (por exemplo, o SDK da Hockey ou Fabric), ela estará listada aqui. Normalmente a integração é feita de forma automática por gerenciadores de dependência, mas pode ser necessário adicionar manualmente aqui.</li>
  <li><em>Copy bundle resources</em>: arquivos de storyboard, assets como imagens, vídeos, e arquivos de áudio, por exemplo, são listados aqui.</li>
</ul>

<p>Além dessas mais comuns e incluídas por padrão, pode ser útil - ou mesmo necessário - incluir uma (ou mais) através da opção <em>New run script phase</em>. Por exemplo, ferramentas de geração de código como <a href="https://github.com/krzyzanowskim/Natalie">Natalie</a> ou <a href="https://github.com/rentzsch/mogenerator">mogenerator</a> podem ter scripts para analisar, respectivamente, os arquivos de storyboard ou Core Data, e ferramentas de <em>lint</em>, como <a href="http://oclint.org">OCLint</a> ou <a href="https://github.com/realm/SwiftLint">SwiftLint</a> podem fazer análises do código e identificar coisas fora do padrão do time ou <em>code smells</em>, sendo comum nesse caso adicionar scripts no começo do processo, e ferramentas como HockeyApp ou Fabric podem pedir para adicionar um script no final, habilitando a nova versão no serviço deles. A imagem abaixo mostra como adicionar uma nova <em>run script phase</em>:</p>

<p><img src="/img/talesp/runscript.png" alt="" /></p>

<h3 id="build-configurations"><em>Build configurations</em></h3>

<p><em>Build Configurations</em> são conjuntos de <em>build settings</em>, a serem usadas por uma determinada compilação, especificada por um <em>scheme</em>. Por padrão, temos sempre duas configurações dessas: <em>Debug</em> e <em>Release</em>. É através dela que podemos, por exemplo, configurar para que sob certas condições, um <em>build setting</em> específico seja usado. Por exemplo, podemos duplicar a <em>build configuration</em> <em>Release</em> como exibido na imagem abaixo, para ter configurações de construção do produto diferente para, digamos, um ambiente corporativo. (a imagem abaixo foi tirada do projeto <a href="https://github.com/manuelmarcos/ribotTeamiOS-tvOS">ribotTeamiOS-tvOS</a>, que demonstra o compartilhamento de código de forma simples entre iOS e tvOS)</p>

<p><img src="/img/talesp/ribotTeam.png" alt="" /></p>

<p>Podemos, com a ajuda da técnica exposta no artigo da Thoughtbot, gerar binários diferentes com <em>Bundle ID</em> diferentes para o ambiente empresarial usando distribuição <em>Enterprise</em>, por exemplo. As facilidades que isso nos dá são muitas!</p>

<h2 id="schemes"><em>Schemes</em></h2>

<p>Por último gostaria de falar um pouco sobre <em>Schemes</em>, que são um conjunto de ações que definem quais <em>targets</em> devem ser construídos, qual conjunto de configurações devem ser usadas para cada tipo de compilação (execução no simulador/dispositivo, teste, <em>profile</em>, para análise estática e arquivamento para distribuição.</p>

<p>Você pode ter múltiplos esquemas, mas apenas um está ativo de cada vez. Por padrão os <em>schemes</em> são armazenados no projeto, mas caso você deseje por exemplo usar o Xcode Server como servidor de integração contínua através do uso de Xcode Bots, o <em>scheme</em> deve ser compartilhado via workspace. A figura abaixo exibe as opções normalmente disponíveis na aba <em>Build</em>, indicando qual <em>target</em> deve ser construído para cada tipo de execução. Como podemos ver, não faz sentido compilar o <em>bundle</em> de testes para a compilação para distribuição - <em>archive</em>. Podemos ver também que esse esquema não foi compartilhado, o que impede seu uso pelos Bots do Xcode.</p>

<p><img src="/img/talesp/schemes.png" alt="" /></p>

<p>Na aba <em>Run</em> temos a chance de configurar a forma como o app é executado - no simulador ou no device - e podemos passar “parâmetros de linha de comando” para a execução do app. Já usei isso para habilitar/desabilitar mensagens no console, em um app onde o requisito era não logar nada, mas para desenvolvimento ligávamos as mensagens de <em>debug</em> - inclusive controlando níveis de mensagens de erro (info, <em>warning</em>, erro, etc) de acordo com o parâmentro. Assim não corríamos a chance de acidentalmente enviar o app para produção exibindo os logs. Essa não é a única forma que isso pode ser feito, mas foi a forma que usamos, e isso pode ter outras utilidades para você :D</p>

<p>Outra funcionalidade da aba <em>Run</em> que já foi muito mais usada no passado - na era pre-ARC - foi habilitar a opção <em>Enable Zombie Objects</em> na aba <em>Diagnostics</em>, o que permitia detectar e corrigir vários bugs de gerenciamento de memória. Você pode ver um pouco mais <a href="http://cocoadev.com/DebuggingAutorelease">aqui</a>, mas não vejo mais tanta utilidade no dia a dia. A imagem abaixo exibe essa aba e mais algumas opções.</p>

<p><img src="/img/talesp/zombies.png" alt="" /></p>

<h1 id="conclusão">Conclusão</h1>

<p>Não quis de forma nenhuma descrever todas essas funcionalidades e conceitos de forma exaustiva, até porque ainda teria MUITO a escrever. Mas acho importante conhecer esses conceitos, nos ajudam na hora de configurar como o app é construído/arquitetado, como é compilado, nos permitem pensar em novas formas de organizar nossos projetos.</p>

<p>Espero que tenham gostado, e que no futuro eu consiga escrever um outro artigo que daria uma espécie de sequência para esse artigo. Bom proveito e bons <em>hacks</em> na forma de construir seus apps :)</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/ios/2016/03/08/layouts-adaptativos-com-uicollectionview-autolayout-e-size-classes/" data-toggle="tooltip" data-placement="top" title="Layouts adaptativos com UICollectionView, Size Classes e Auto Layout">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/gamedev/2016/03/10/Unity3DeoMundoApple/" data-toggle="tooltip" data-placement="top" title="Unity3D e o Mundo Apple">Próximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto — Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
