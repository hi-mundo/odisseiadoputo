<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento — artigos, tutoriais e opinião.">

    <title>Você tem um momento para falar sobre testar suas View Controllers? - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/testes/2017/03/09/voce-tem-um-momento-para-falar-sobre-testar-suas-view-controllers/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Você tem um momento para falar sobre testar suas View Controllers?</h1>
                        
                        <h2 class="subheading">Um resumo de como comecei a escrever Snapshot Tests</h2>
                        
                        <span class="meta">Postado por “Christian Sampaio“ em 09/03/2017</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Você tem um momento para falar sobre testar suas View Controllers?&url=http://localhost:4000/testes/2017/03/09/voce-tem-um-momento-para-falar-sobre-testar-suas-view-controllers/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/testes/2017/03/09/voce-tem-um-momento-para-falar-sobre-testar-suas-view-controllers/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/testes/2017/03/09/voce-tem-um-momento-para-falar-sobre-testar-suas-view-controllers/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/testes/2017/03/09/voce-tem-um-momento-para-falar-sobre-testar-suas-view-controllers/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<h2 id="o-impasse">O impasse</h2>

<p>Nós, conhecidos como desenvolvedores <em>front-end</em>, muitas vezes nos encontramos com o impasse dos testes unitários. As perguntas são sempre as mesmas. O que testar? Como escrever código que seja fácil de testar? Como praticar <em>TDD</em>? Vale a pena escrever e manter testes? <br />
Alguns vão mais longe na discussão e buscam indicadores que garantirão a qualidade e robustez de um projeto, como cobertura de teste mínima.</p>

<p>Acho muito relevante a empolgação sobre o assunto, desde que não esqueçamos do objetivo dos testes unitários: validar o funcionamento de um sistema. Todas as outras consequências não são nada mais do que apenas consequências. Por isso, devemos ser muito cautelosos ao afirmar que seguir todos os princípios <em>SOLID</em>, ou qualquer outro regulamento, <a href="https://twitter.com/jduv2683/status/834608248569417728">significa qualidade garantida</a>. Novamente, é muito válida a intenção de encontrar teorias para que possamos oficializar metodologias eficientes para o nosso ofício. Entretanto, é essencial validarmos que essas regras vão realmente atingir o objetivo almejado. Caso a resposta for negativa, é nosso papel encontrar uma solução equivalente.</p>

<p>E é na nossa área, desenvolvimento <em>front-end</em>, que <em>Snapshot Tests</em> se apresenta como uma solução justa para um problema impertinente – testar código de <em>UI</em>. É fato que grande parte de um projeto <em>front-end</em> é código dedicado à parte visual do programa, como o próprio nome sugere. Ao passo que a maioria dos guias de como seguir <em>TDD</em> não incluem uma linha desse tipo de código. O que faz sentido, porque não desejo a ninguém escrever testes para verificar se todos os elementos visuais, de uma determinada interface, estejam nas posições, cores, proporções, fontes, ou opacidade corretas.</p>

<h2 id="um-caso-de-teste">Um caso de teste</h2>

<p>Abandonando a discussão filosófica (ufa!), tomemos como exemplo um aplicativo iOS. Que, por sua vez, implica o uso de <code class="language-plaintext highlighter-rouge">UIViewController</code>s na maioria dos casos – uma área negligenciada em termos de testes, por motivos de praticidade geralmente.</p>

<p>Aqui cabe a leitura de dois textos do caro <a href="https://twitter.com/diogot">Diogo</a>, doutor <sup id="fnref:1"><a href="#fn:1" class="footnote" rel="footnote" role="doc-noteref">1</a></sup>. <a href="http://invariante.com/2015/10/20/todo-view-controller-deveria-ter-delegate/">O primeiro</a> elabora sobre delegar as ações originadas de uma <code class="language-plaintext highlighter-rouge">UIViewController</code>. <a href="http://invariante.com/2016/04/18/minimizando-acoplamento-view-e-viewcontrollers/">O segundo</a> sugere o uso de <em>view models</em>, que, em suma, fornecem somente as informações estritamente necessárias para que <code class="language-plaintext highlighter-rouge">UIViewController</code>s configurem suas <em>views</em>.  Tendo essas ideias estabelecidas, <code class="language-plaintext highlighter-rouge">UIViewController</code>s tendem a ficar simples e fáceis de serem inicializadas em diferentes contextos isolados, como em um caso de teste. Meio caminho andado. Se o nosso objetivo é testar, precisamos verificar se o resultado está de acordo com o esperado. É nessa tarefa que <em>Snapshot Tests</em> facilita nossa vida.</p>

<p>Quando li sobre a ideia pela primeira vez, achei criativa. Mas descartei involuntariamente porque assumi que seria difícil de configurar, manter ou funcionar na prática. Eu sei, atitude errada. Mas você já deve ter notado que mudei de opinião em algum momento. Pois bem, numa bela manhã, meu ex-colega - porém ainda amigo - <a href="https://twitter.com/larslockefeer">Lars</a>, submeteu uma <em>Pull Request</em> com umas <em>screenshots</em>. A narrativa naquele <em>diff</em> me convenceu por si só. Veja um exemplo análogo, retirado do <a href="https://github.com/artsy/eigen/pull/2169/files">projeto open source Eigen, da Artsy</a>.</p>

<p><img src="/img/chrisfsampaio/snapshots-pr-example.png" alt="" /></p>

<p>De maneira consolidada, podemos analisar e revisar as mudanças feitas em termos de código e quais são as consequências visuais dessas mudanças. O que além de facilitar muito o processo de revisão, é também muito conveniente para documentação e referência futura.</p>

<p>Mas não nos desviemos do objetivo: validar o funcionamento. E para entender como <em>Snapshot Tests</em> funcionam, vamos usar o <em>framework</em> <a href="https://github.com/facebook/ios-snapshot-test-case">FBSnapshotTestCase</a>, do Facebook. Depois de <a href="https://github.com/facebook/ios-snapshot-test-case#installation-with-cocoapods">integrar o <em>framework</em></a> ao seu projeto, o processo para escrever testes é composto pelas seguintes partes:</p>

<ol>
  <li>
    <p>Começamos escrevendo um caso de teste como qualquer outro, exceto pela parte que herdaremos de <code class="language-plaintext highlighter-rouge">FBSnapshotTestCase</code> ao invés de <code class="language-plaintext highlighter-rouge">XCTestCase</code>.</p>
  </li>
  <li>
    <p>Escrevemos uma função para testar um estado da <code class="language-plaintext highlighter-rouge">UIViewController</code> sob teste.</p>
  </li>
  <li>
    <p>Atribuímos o valor <code class="language-plaintext highlighter-rouge">true</code> à propriedade <code class="language-plaintext highlighter-rouge">recordMode</code> do caso de teste. Esse é o passo que irá fazer com que imagens de referência sejam geradas.</p>
  </li>
  <li>
    <p>Utilizamos a função <code class="language-plaintext highlighter-rouge">FBSnapshotVerifyView</code>, passando como parâmetro a <em>view</em> associada à <code class="language-plaintext highlighter-rouge">UIViewController</code> em questão. Essa função irá capturar o resultado visual da <em>view</em> recebida, e uma imagem, usada como referência, é salva em disco. O caminho do arquivo é escrito no <em>console</em> para fácil acesso.</p>
  </li>
  <li>
    <p>Verificamos se o arquivo de referência corresponde ao resultado esperado. Em caso negativo, ajustamos o código sob teste e repetimos o passo anterior até obtermos uma imagem satisfatória.</p>
  </li>
  <li>
    <p>Atribuímos o valor <code class="language-plaintext highlighter-rouge">false</code> à propriedade <code class="language-plaintext highlighter-rouge">recordMode</code> do caso de teste. Este último passo usará as chamadas à <code class="language-plaintext highlighter-rouge">FBSnapshotVerifyView</code> para comparar, ponto a ponto, o resultado visual da <em>view</em> recebida com a imagem de referência já existente. O teste somente irá passar se a comparação não vir a falhar.</p>
  </li>
</ol>

<p><img src="/img/chrisfsampaio/butterfly-old-photo.jpg" alt="" /></p>

<p>Um teste simples ficaria semelhante às linhas do código a seguir.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">XCTest</span>
<span class="kd">import</span> <span class="kt">FBSnapshotTestCase</span>
<span class="kd">@testable</span> <span class="kd">import</span> <span class="kt">MyHumbleApp</span>

<span class="kd">class</span> <span class="kt">LoginViewControllerTests</span><span class="p">:</span> <span class="kt">FBSnapshotTestCase</span> <span class="p">{</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">setUp</span><span class="p">()</span>
        <span class="n">recordMode</span> <span class="o">=</span> <span class="kc">true</span> <span class="c1">// Mudar para false quando o teste gerar um resultado satisfatório.</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">testEmptyState</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">LoginViewController</span><span class="p">()</span>
        <span class="n">viewController</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="kt">UIScreen</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span>
        <span class="kt">FBSnapshotVerifyView</span><span class="p">(</span><span class="n">viewController</span><span class="o">.</span><span class="n">view</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Para evitar a repetição de alguns caracteres, costumo usar uma classe base que encapsula as particularidades dos frameworks envolvidos:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">XCTest</span>
<span class="kd">import</span> <span class="kt">FBSnapshotTestCase</span>

<span class="kd">class</span> <span class="kt">BaseSnapshotTests</span><span class="p">:</span> <span class="kt">FBSnapshotTestCase</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">shouldRecord</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"Should be overriden"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">setUp</span><span class="p">()</span>
        <span class="k">self</span><span class="o">.</span><span class="n">isDeviceAgnostic</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">self</span><span class="o">.</span><span class="n">recordMode</span> <span class="o">=</span> <span class="nf">shouldRecord</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">validateView</span><span class="p">(</span><span class="n">of</span> <span class="nv">viewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="nv">windowLevel</span><span class="p">:</span> <span class="kt">UIWindowLevel</span> <span class="o">=</span> <span class="kt">UIWindowLevelStatusBar</span><span class="p">,</span> <span class="nv">containerSize</span><span class="p">:</span> <span class="kt">CGSize</span> <span class="o">=</span> <span class="kt">UIScreen</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="n">bounds</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="nv">file</span><span class="p">:</span> <span class="kt">StaticString</span> <span class="o">=</span> <span class="kd">#file</span><span class="p">,</span> <span class="nv">line</span><span class="p">:</span> <span class="kt">UInt</span> <span class="o">=</span> <span class="kd">#line</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">origin</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="n">containerSize</span><span class="p">)</span>
        <span class="k">let</span> <span class="nv">window</span> <span class="o">=</span> <span class="kt">UIWindow</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="n">frame</span><span class="p">)</span>
        <span class="n">window</span><span class="o">.</span><span class="n">backgroundColor</span> <span class="o">=</span> <span class="o">.</span><span class="n">clear</span>
        <span class="n">window</span><span class="o">.</span><span class="n">windowLevel</span> <span class="o">=</span> <span class="n">windowLevel</span>
        <span class="n">window</span><span class="o">.</span><span class="n">rootViewController</span> <span class="o">=</span> <span class="n">viewController</span>
        <span class="n">window</span><span class="o">.</span><span class="n">isHidden</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="n">viewController</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
        <span class="n">viewController</span><span class="o">.</span><span class="n">view</span><span class="o">.</span><span class="nf">layoutIfNeeded</span><span class="p">()</span>
        <span class="kt">FBSnapshotVerifyView</span><span class="p">(</span><span class="n">viewController</span><span class="o">.</span><span class="n">view</span><span class="p">,</span> <span class="nv">file</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span> <span class="nv">line</span><span class="p">:</span> <span class="n">line</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">validate</span><span class="p">(</span><span class="nv">view</span><span class="p">:</span> <span class="kt">UIView</span><span class="p">,</span> <span class="n">withSize</span> <span class="nv">size</span><span class="p">:</span> <span class="kt">CGSize</span><span class="p">,</span> <span class="nv">file</span><span class="p">:</span> <span class="kt">StaticString</span> <span class="o">=</span> <span class="kd">#file</span><span class="p">,</span> <span class="nv">line</span><span class="p">:</span> <span class="kt">UInt</span> <span class="o">=</span> <span class="kd">#line</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">view</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="kt">CGRect</span><span class="p">(</span><span class="nv">origin</span><span class="p">:</span> <span class="kt">CGPoint</span><span class="o">.</span><span class="n">zero</span><span class="p">,</span> <span class="nv">size</span><span class="p">:</span> <span class="n">size</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="nf">layoutIfNeeded</span><span class="p">()</span>
        <span class="kt">FBSnapshotVerifyView</span><span class="p">(</span><span class="n">view</span><span class="p">,</span> <span class="nv">file</span><span class="p">:</span> <span class="n">file</span><span class="p">,</span> <span class="nv">line</span><span class="p">:</span> <span class="n">line</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Simplificando, assim, o nosso caso de teste de exemplo:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">@testable</span> <span class="kd">import</span> <span class="kt">MyHumbleApp</span>

<span class="kd">class</span> <span class="kt">LoginViewControllerTests</span><span class="p">:</span> <span class="kt">FBSnapshotTestCase</span> <span class="p">{</span>

    <span class="kd">func</span> <span class="nf">shouldRecord</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>
        <span class="k">return</span> <span class="kc">true</span> <span class="c1">// Mudar para `false` quando o teste gerar um resultado satisfatório.</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">testEmptyState</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">viewController</span> <span class="o">=</span> <span class="kt">LoginViewController</span><span class="p">()</span>
        <span class="nf">validateView</span><span class="p">(</span><span class="nv">of</span><span class="p">:</span> <span class="n">viewController</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="em-síntese">Em síntese</h2>

<p>É importante ressaltar que, ao escrever este tipo de teste – ou qualquer outro teste unitário -, é necessário mantê-los. Isto é, ajustá-los conforme os requisitos mudarem, ou excluí-los se os requisitos não existirem mais. É também necessário que estes testes sejam executados com certa frequência, utilizando integração contínua de preferência. <em>Snapshot Tests</em> são rápidos e podem ser executados juntamente com os outros testes unitários existentes no projeto.</p>

<p>Naturalmente, os testes também incluirão o código necessário para configurar as <code class="language-plaintext highlighter-rouge">UIViewController</code>s. Esse código foi omitido no exemplo por motivo de clareza. Mas devemos nos atentar em minimizar e isolar esse código o máximo possível, utilizando <em>view models</em>  ou não. Se um teste unitário tem muitas dependências, há uma grande chance dele não ser mantido apropriadamente ou facilmente mal interpretado, por outros ou pelo próprio autor, no futuro.</p>

<p>Uma outra consequência, é a mudança no processo utilizado para escrever código de <em>UI</em>. Para construir a última tela de um fluxo, por exemplo, muitas vezes são necessários vários <em>taps</em>, <em>swipes</em> e <em>bytes</em> trafegados na internet. Consumindo muito tempo acumulado pelas infinitas iterações para atingir aquele resultado <em>pixel perfect</em>, que deixa seu amigo <em>designer</em> de olhos cheios. Este tempo não é necessário quando se escreve um <em>Snapshot Test</em> para sua <em>UIViewController</em>. Você pode até tentar convencer seu amigo <em>designer</em> a participar do processo de code review, verificando se as imagens de referência estão de acordo, e mitigando assim, a necessidade daquele ticket recorrente e entitulado “Design Review”.</p>

<h2 id="epílogo">Epílogo</h2>

<p>De modo geral, como foi sugerido, tenho experiências positivas com <em>Snapshot Testing</em>. Veja, não estou dizendo que foi a solução de todos os meus problemas, mas sim uma boa ferramenta que ajudou manter minhas <code class="language-plaintext highlighter-rouge">UIViewController</code>s mais estáveis.</p>

<p>Agradeço pela leitura e espero que essa ferramenta possa te ajudar também.</p>

<p>Caso queira entrar em contato, estou no <a href="https://twitter.com/chrisfsampaio">Twitter (@chrisfsampaio)</a> e no Slack do <a href="http://iosdevbr.herokuapp.com/">iOSDevBR</a> (@christian).</p>

<hr />

<h2 id="referências">Referências</h2>

<ul>
  <li>Novamente agradeço ao estimado <a href="https://twitter.com/larslockefeer">Lars</a>. Que depois de ter me apresentado o assunto, <a href="https://twitter.com/larslockefeer/status/753496126393880576">compartilhou sua experiência</a> numa <a href="https://twitter.com/larslockefeer/status/753495593268510720">apresentação</a> do <a href="http://cocoaheads.nl/">CocoaHeads dos Países Baixos</a>.</li>
  <li>Vale também mencionar <a href="https://www.objc.io/issues/15-testing/snapshot-testing">um relato</a>, do <a href="http://orta.io">Orta Therox</a>, deveras parecido com a experiência que tive.</li>
</ul>

<hr />

<h3 id="errata">Errata</h3>
<ol>
  <li>
    <p>Meu amigo <a href="https://twitter.com/marcelofabri_">Fabri</a> fez uma boa ressalva – executar o teste antes de gerar a primeira imagem e observamos que o mesmo irá falhar. Este passo é importante para validarmos que o teste falha quando não há arquivo para ser usado como referência.</p>
  </li>
  <li>
    <p>O caro <a href="https://twitter.com/marcelofabri_">Fabri</a> também lembrou que vale mencionar o <a href="https://github.com/dblock/ios-snapshot-test-case-expecta"><em>matcher</em> para <code class="language-plaintext highlighter-rouge">Expecta</code></a>, que permite uma sintáxe mais natural nas linhas de:</p>
  </li>
</ol>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="nf">expect</span><span class="p">(</span><span class="n">view</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="nf">recordSnapshot</span><span class="p">()</span>
    <span class="nf">expect</span><span class="p">(</span><span class="n">view</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="nf">haveValidSnapshot</span><span class="p">()</span>
    <span class="nf">expect</span><span class="p">(</span><span class="n">view</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="nf">haveValidSnapshotWithTolerance</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
    <span class="nf">expect</span><span class="p">(</span><span class="n">view</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="o">.</span><span class="nf">haveValidSnapshotNamedWithTolerance</span><span class="p">(</span><span class="s">@"unique snapshot name"</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
</code></pre></div></div>

<p><br /></p>

<h4 id="notas">Notas</h4>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1">
      <p>Na verdade, recomendo a leitura de todos os textos que estão lá no <a href="http://invariante.com/">invariante</a>. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/ios/2017/03/07/lldb-e-seu-amigo/" data-toggle="tooltip" data-placement="top" title="LLDB é seu amigo">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/comunidade/2017/03/10/Bugreport-101/" data-toggle="tooltip" data-placement="top" title="Bugreport 101">Próximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto — Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
