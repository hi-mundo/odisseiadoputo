<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento â€” artigos, tutoriais e opiniÃ£o.">

    <title>Unit Tests 101 - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/testes/2017/03/06/unit-tests-101/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Unit Tests 101</h1>
                        
                        <h2 class="subheading">Primeir[Ã­ssim]os passos</h2>
                        
                        <span class="meta">Postado por Emannuel Carvalho em 06/03/2017</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Unit Tests 101&url=http://localhost:4000/testes/2017/03/06/unit-tests-101/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/testes/2017/03/06/unit-tests-101/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/testes/2017/03/06/unit-tests-101/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/testes/2017/03/06/unit-tests-101/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<h2 id="por-que-eu-devo-testar">Por que eu devo testar?</h2>

<p>NÃ£o Ã© preciso escrever muito para convencer sobre a importÃ¢ncia de testes unitÃ¡rios em um app. Se vocÃª programa hÃ¡ algum tempo, jÃ¡ passou por um daqueles momentos em que Ã© preciso fazer vÃ¡rias alteraÃ§Ãµes em uma parte do cÃ³digo e fica aquele frio na barriga porque nÃ£o tem nada garantindo que o cÃ³digo que vocÃª alterou nÃ£o vai quebrar outras partes com as quais ele estÃ¡ relacionado. Nessas horas, uma boa cobertura de testes faz muito bem para o app e para os usuÃ¡rios - e tambÃ©m pra nossa saÃºde mental e cardÃ­aca.</p>

<p>Se vocÃª nÃ£o programa hÃ¡ muito tempo, talvez ainda nÃ£o tenha sentido falta dos testes unitÃ¡rios. Nesse caso, vocÃª pode escolher acreditar que eles fazem bem e se proteger ou esperar para aprender com a vida. Ambas as abordagens tÃªm vantagens e desvantagens. Eu sugeriria a primeira, mas no fim das contas, <em>itâ€™s up to you</em>.</p>

<h2 id="testes-unitÃ¡rios-x-tdd-x-testes-de-ui">Testes unitÃ¡rios x TDD x Testes de UI</h2>

<p>Ã‰ importante diferenciar â€œtestes unitÃ¡riosâ€ de â€œTDDâ€ e â€œTestes de UIâ€ -  esses sÃ£o termos que vocÃª provavelmente vai encontrar por aÃ­ enquanto estiver pesquisando por testes. Os <em>testes unitÃ¡rios</em> servem para verificar se cada <em>unidade</em> (classe, struct, enum) estÃ¡ funcionando da maneira que deveria. A ideia bÃ¡sica Ã© criar um ambiente controlado (substituindo os objetos ou <em>value types</em> com os quais ela se relaciona por mocks, stubs, etc.) onde Ã© possÃ­vel observar o comportamento dessa classe (verificar se os mÃ©todos que deveriam ter sido chamados foram chamados e se as properties que deveriam ter sido alteradas foram alteradas).</p>

<p>Quando falamos de â€œTDDâ€ estamos nos referindo a uma <em>metodologia</em> de desenvolvimento. Ã‰ um <em>jeito de fazer as coisas</em>. Funciona mais ou menos assim: antes de escrever o cÃ³digo para implementar uma dada feature, vocÃª deve escrever os testes unitÃ¡rios pra esse cÃ³digo. Uma vez escritos os testes - que obviamente nÃ£o vÃ£o passar! - vocÃª deve implementar a feature, fazendo com que os testes passem. Depois disso vocÃª deve refatorar o cÃ³digo sabendo que se vocÃª fizer alguma besteira os testes vÃ£o te avisar.</p>

<p>Os Testes de UI sÃ£o bem diferentes. Neles vocÃª â€œvÃªâ€ o seu app pelo lado de fora. VocÃª interage com o app como um usuÃ¡rio, com touches, swipes, etc. e verifica se os elementos que deveriam aparecer aparecem e se as alteraÃ§Ãµes estÃ£o de acordo com o comportamento esperado. NÃ£o sÃ£o as <em>unidades</em> que sÃ£o testadas e sim o <em>comportamento</em> do app como um todo.</p>

<p>Nesse post a gente vai falar de <em>Testes UnitÃ¡rios</em>.</p>

<h2 id="testando-as-unidades">Testando as unidades</h2>

<p>Como eu mencionei acima, a ideia de um teste unitÃ¡rio Ã© garantir que uma classe ou value type estÃ¡ funcionando como deveria, ou seja, quando chamamos um determinado mÃ©todo, com determinados parÃ¢metros, os diferentes objetos com os quais ela se relaciona terÃ£o os seus mÃ©todos chamados com os parÃ¢metros certos. SÃ£o trÃªs Aâ€™s: <em>Arrange</em>, <em>Act</em> e <em>Assert</em>.</p>

<p>Imagina a seguinte classe:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">ViewController</span> <span class="p">{</span>
    
    <span class="k">var</span> <span class="nv">messagePresenter</span><span class="p">:</span> <span class="kt">MessagePresenter</span><span class="p">?</span> <span class="c1">// MessagePresenter Ã© um protocol ğŸ˜‰</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>
        <span class="n">messagePresenter</span> <span class="o">=</span> <span class="kt">AlertMessagePresenter</span><span class="p">()</span> <span class="c1">// O AlertMessagePresenter implementa o protocolo MessagePresenter</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">displayAlert</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">messagePresenter</span><span class="p">?</span><span class="o">.</span><span class="nf">presentMessage</span><span class="p">(</span><span class="s">"Something happened!"</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

<p>Para testar o <code class="language-plaintext highlighter-rouge">ViewController</code> Ã© preciso garantir duas coisas: (1) que apÃ³s o <code class="language-plaintext highlighter-rouge">viewDidLoad</code> o <code class="language-plaintext highlighter-rouge">messagePresenter</code> terÃ¡ sido inicializado, (2) que, ao chamar o mÃ©todo <code class="language-plaintext highlighter-rouge">displayAlert</code>, o mÃ©todo <code class="language-plaintext highlighter-rouge">presentMessage</code> serÃ¡ chamado no <code class="language-plaintext highlighter-rouge">messagePresenter</code> e os parÃ¢metros foram passados corretamente.</p>

<p>Um pouco de mÃ£o-na-massa pra tudo isso fazer sentido.</p>

<p>âš ï¸ Nesse post eu vou mostrar um exemplo de testes usando XCTests. Existem outras ferramentas para testes unitÃ¡rios em iOS, mas a ideia geral Ã© basicamente a mesma.
Se vocÃª quiser seguir os passos a seguir, tem um projeto <a href="https://github.com/emannuelOC/tutorial_unit_tests" target="_blank">aqui</a> esperando para ser testado ğŸ¤“.</p>

<h3 id="xcode-">Xcode ğŸ’š</h3>

<p><del>Quase</del> tudo relacionado aos nossos testes estÃ¡ no â€œTests Navigatorâ€, do lado esquerdo lÃ¡ em cima.</p>

<p><img src="/img/emannuelOC/tests_navigator.png" /></p>

<p>Ao selecionar essa tab, vocÃª vai achar um botÃ£o de adicionar na parte de baixo da tela Ã  esquerda.</p>

<p><img src="/img/emannuelOC/new_test_class.png" /></p>

<p>Crie uma nova â€œClasse de Testeâ€ chamada <code class="language-plaintext highlighter-rouge">ViewControllerTests</code>, subclasse de <code class="language-plaintext highlighter-rouge">XCTestCase</code>. Em geral as classes de teste tÃªm o nome da classe que elas vÃ£o testar + â€œTestsâ€.
Os mÃ©todos de teste devem comeÃ§ar com <code class="language-plaintext highlighter-rouge">test..</code>; nÃ£o devem receber nenhum parÃ¢metro e nÃ£o devem retornar nada:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">testSomething</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// ...</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Os mÃ©todos <code class="language-plaintext highlighter-rouge">setUp</code> e <code class="language-plaintext highlighter-rouge">tearDown</code> sÃ£o sempre chamados antes e depois de cada teste, respectivamente. No nosso exemplo eles nÃ£o vÃ£o ser necessÃ¡rios.</p>

<p>âš ï¸ NÃ£o deixe de importar o seu target no arquivo de testes:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">XCTest</span>
<span class="kd">@testable</span> <span class="kd">import</span> <span class="kt">TutorialUnitTests</span> <span class="c1">// sem esse import o seu projeto nÃ£o fica visÃ­vel aqui!!!</span>
</code></pre></div></div>

<h3 id="lets-do-our-bestest-best--test-got-it-">Letâ€™s do our bestest (best + test, got it? ğŸ˜œ)</h3>

<p>Vamos comeÃ§ar com o bÃ¡sico. ApÃ³s o <code class="language-plaintext highlighter-rouge">viewDidLoad</code> o view controller deve ter inicializado o seu <code class="language-plaintext highlighter-rouge">messagePresenter</code>. Vamos testar se isso estÃ¡ acontecendo:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">testLoading</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Arrange</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">sut</span> <span class="o">=</span> <span class="nf">getViewController</span><span class="p">()</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span> <span class="c1">// `sut` Ã© uma convenÃ§Ã£o: Subject Under Test</span>
        
    <span class="c1">// Act</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">sut</span><span class="o">.</span><span class="n">view</span>
        
    <span class="c1">// Assert</span>
    <span class="kt">XCTAssertNotNil</span><span class="p">(</span><span class="n">sut</span><span class="o">.</span><span class="n">messagePresenter</span><span class="p">,</span> <span class="s">"It should have initialized its messagePresenter."</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Para facilitar as coisas, eu coloquei um storyboard identifier no <code class="language-plaintext highlighter-rouge">viewController</code> e criei um metodozinho bem simples que cria o viewController para ser testado:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">getViewController</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">ViewController</span><span class="p">?</span> <span class="p">{</span>
    <span class="k">guard</span> <span class="k">let</span> <span class="nv">vc</span> <span class="o">=</span> <span class="kt">UIStoryboard</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"Main"</span><span class="p">,</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kc">nil</span><span class="p">)</span><span class="o">.</span><span class="nf">instantiateViewController</span><span class="p">(</span><span class="nv">withIdentifier</span><span class="p">:</span> <span class="s">"SimpleVC"</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">ViewController</span> <span class="k">else</span> <span class="p">{</span>
        <span class="kt">XCTAssert</span><span class="p">(</span><span class="kc">false</span><span class="p">,</span> <span class="s">"No viewController with that identifier"</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">nil</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">vc</span>
<span class="p">}</span>

</code></pre></div></div>

<p>O â€œarrangeâ€ e o â€œactâ€ nesse caso sÃ£o bem simples. Basta criar o <code class="language-plaintext highlighter-rouge">viewController</code> e chamar a property <code class="language-plaintext highlighter-rouge">view</code> e o mÃ©todo <code class="language-plaintext highlighter-rouge">viewDidLoad</code> serÃ¡ chamado (isso acontece porque no getter da <code class="language-plaintext highlighter-rouge">view</code> o <code class="language-plaintext highlighter-rouge">viewController</code> chama o mÃ©todo <code class="language-plaintext highlighter-rouge">loadView</code> e ao final desse mÃ©todo o <code class="language-plaintext highlighter-rouge">viewDidLoad</code> Ã© chamado).</p>

<p>Para verificar se tudo aconteceu como deveria nÃ³s chamamos a funÃ§Ã£o <code class="language-plaintext highlighter-rouge">XCTAssertNotNil</code> que recebe uma expressÃ£o e uma mensagem que serÃ¡ exibida se o teste falhar - ou seja, se a expressÃ£o passada for <code class="language-plaintext highlighter-rouge">nil</code>. A funÃ§Ã£o mais bÃ¡sica, <code class="language-plaintext highlighter-rouge">XCTAssert</code>, que recebe um <code class="language-plaintext highlighter-rouge">Bool</code> tem diferentes variantes: <code class="language-plaintext highlighter-rouge">XCTAssertNotNil</code>, <code class="language-plaintext highlighter-rouge">XCTAssertEqual</code>, etc.</p>

<p>Execute o teste clicando no losango Ã  esquerda da assinatura do teste ou com os atalhos (<code class="language-plaintext highlighter-rouge">cmd + u</code> para executar todos os testes ou <code class="language-plaintext highlighter-rouge">cmd + option + ctrl + u</code> para executar o arquivo atual de testes). Se tudo estiver certo, o teste deve passar e o losango ficarÃ¡ verde com um check branco âœ…. Para validar que o teste funciona de fato vocÃª pode comentar a linha onde o <code class="language-plaintext highlighter-rouge">messagePresenter</code> Ã© inicializado na classe <code class="language-plaintext highlighter-rouge">ViewController</code> e rodar os testes novamente. O teste deve falhar e o losango vai ficar vermelho com um â€œxâ€. Se isso nÃ£o acontecer, chame os bombeiros! ğŸš’ ğŸ‘¨ğŸ»â€ğŸš’ ğŸ”¥ Alguma coisa estÃ¡ fora do lugar.</p>

<h3 id="a-little-further">A little further</h3>

<p>Agora, vamos para um teste um pouco menos simples.</p>

<p>Antes de tudo, nÃ³s devemos criar um ambiente que permita a observaÃ§Ã£o do comportamento da unidade que queremos testar. Isso significa substituir os objetos com os quais ela se relaciona por outros objetos â€œsemelhantesâ€ que nos permitam verificar de que modo a classe que estÃ¡ sendo testada interagiu com eles.</p>

<p>Existem vÃ¡rias ferramentas para ajudar na criaÃ§Ã£o desse â€œambienteâ€, especialmente para Objective-C. Em swift eles nÃ£o sÃ£o nem tÃ£o abundantes nem tÃ£o necessÃ¡rios. Usar protocolos pra definir as abstraÃ§Ãµes de cada tipo permite que seja muito simples criar um Mock para qualquer classe ou value type.</p>

<p>No nosso caso, vamos criar um <code class="language-plaintext highlighter-rouge">MockMessagePresenter</code> que deve nos mostrar trÃªs coisas: (1) se o mÃ©todo foi chamado; (2) se a mensagem passada foi â€œSomething happenedâ€; e (3) se o view controller passado foi o view controller que chamou o mÃ©todo.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">MockMessagePresenter</span><span class="p">:</span> <span class="kt">MessagePresenter</span> <span class="p">{</span>
    
    <span class="k">var</span> <span class="nv">presentCalled</span> <span class="o">=</span> <span class="kc">false</span>
    <span class="k">var</span> <span class="nv">message</span><span class="p">:</span> <span class="kt">String</span><span class="p">?</span>
    <span class="k">var</span> <span class="nv">viewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">?</span>
    
    <span class="kd">func</span> <span class="nf">presentMessage</span><span class="p">(</span><span class="n">_</span> <span class="nv">message</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="n">on</span> <span class="nv">viewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">presentCalled</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">self</span><span class="o">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
        <span class="k">self</span><span class="o">.</span><span class="n">viewController</span> <span class="o">=</span> <span class="n">viewController</span>
    <span class="p">}</span>
    
<span class="p">}</span>

</code></pre></div></div>

<p>No nosso teste nÃ³s precisamos criar um viewController e passar para ele um <code class="language-plaintext highlighter-rouge">MockMessagePresenter</code>. Desta forma, quando chamarmos o <code class="language-plaintext highlighter-rouge">displayAlert</code> o viewController irÃ¡ interagir com o nosso Mock e nÃ³s poderemos ver se tudo ocorreu como esperado.</p>

<p>O nosso teste fica mais ou menos assim:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">testCallingPresenter</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Arrange</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">sut</span> <span class="o">=</span> <span class="nf">getViewController</span><span class="p">()</span> <span class="k">else</span> <span class="p">{</span> <span class="k">return</span> <span class="p">}</span>
        <span class="k">let</span> <span class="nv">messagePresenter</span> <span class="o">=</span> <span class="kt">MockMessagePresenter</span><span class="p">()</span>
        <span class="n">sut</span><span class="o">.</span><span class="n">messagePresenter</span> <span class="o">=</span> <span class="n">messagePresenter</span>
        
        <span class="c1">// Act</span>
        <span class="n">sut</span><span class="o">.</span><span class="nf">displayAlert</span><span class="p">()</span>
        
        <span class="c1">// Assert</span>
        <span class="kt">XCTAssert</span><span class="p">(</span><span class="n">messagePresenter</span><span class="o">.</span><span class="n">presentCalled</span><span class="p">,</span> <span class="s">"It should have called presentMessage()"</span><span class="p">)</span>
        <span class="kt">XCTAssert</span><span class="p">(</span><span class="n">messagePresenter</span><span class="o">.</span><span class="n">message</span> <span class="o">==</span> <span class="s">"Something happened!"</span><span class="p">,</span> <span class="s">"It should have passed the right message."</span><span class="p">)</span>
        <span class="kt">XCTAssert</span><span class="p">(</span><span class="n">messagePresenter</span><span class="o">.</span><span class="n">viewController</span> <span class="o">==</span> <span class="n">sut</span><span class="p">,</span> <span class="s">"It should the right viewController."</span><span class="p">)</span>
        
    <span class="p">}</span>

</code></pre></div></div>

<p>Rode os testes e veja se estÃ¡ tudo bem.</p>

<p>VocÃª pode alterar os parÃ¢metros e â€œtestarâ€ o teste - nÃ£o adianta nada ter um teste que nÃ£o falhe quando algo estÃ¡ errado! Comente a chamada do mÃ©todo, passe parÃ¢metros errados e veja se o seu teste vai apontar os problemas.</p>

<p>Como vocÃª deve ter notado, esses dois testes simples garantem que o nosso viewController estÃ¡ funcionando como deveria. Isso nos dÃ¡ a seguranÃ§a de que, se algum dia, sem querer, alguÃ©m apagar o <code class="language-plaintext highlighter-rouge">viewDidLoad</code> ou alterar os parÃ¢metros no <code class="language-plaintext highlighter-rouge">presentMessage</code> os testes vÃ£o avisar. Obviamente, no nosso exemplo daria pra notar isso olhando para o cÃ³digo, mas vocÃª pode imaginar como seria diferente em uma classe com algumas centenas de linhas de cÃ³digo, que contÃ©m vÃ¡rias chamadas importantes na superclasse, por exemplo. Os testes permitem que a manutenÃ§Ã£o no cÃ³digo seja uma atividade segura. ğŸ‘·ğŸ»</p>

<h2 id="uma-nota-sobre-arquitetura-">Uma nota sobre â€œarquiteturaâ€ ğŸ›</h2>

<p>VocÃª deve ter notado que o teste sÃ³ foi possÃ­vel porque nÃ³s tÃ­nhamos como substituir o <code class="language-plaintext highlighter-rouge">messagePresenter</code> por um outro objeto com a nossa implementaÃ§Ã£o. Tente imaginar como nÃ³s farÃ­amos isso se nÃ£o houvesse uma property <code class="language-plaintext highlighter-rouge">messagePresenter</code> no view controller e, em vez disso, o mÃ©todo <code class="language-plaintext highlighter-rouge">displayAlert</code> tivesse a seguinte implementaÃ§Ã£o:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">func</span> <span class="nf">displayAlert</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">messagePresenter</span> <span class="o">=</span> <span class="kt">AlertMessagePresenter</span><span class="p">()</span>
    <span class="n">messagePresenter</span><span class="o">.</span><span class="nf">presentMessage</span><span class="p">(</span><span class="s">"Something happened!"</span><span class="p">,</span> <span class="nv">on</span><span class="p">:</span> <span class="k">self</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>O objeto com o qual a classe se relaciona Ã© criado dentro do mÃ©todo e deixa de existir assim que o mÃ©todo retorna. NÃ£o seria possÃ­vel testar o funcinamento do view controller sem depender do funcionamento de outras unidades. Por isso, Ã© importante que o nosso cÃ³digo seja criado de modo que possibilite testar cada unidade separadamente (<a href="https://en.wikipedia.org/wiki/Dependency_injection">Dependency Injection</a>). SÃ³ esse jeito de pensar jÃ¡ tornarÃ¡ o cÃ³digo bem mais limpo e fÃ¡cil de manter, alÃ©m do jÃ¡ mencionado benefÃ­cio de poder â€œbrincarâ€ tranquilamente sabendo que os testes vÃ£o nos avisar se fizermos alguma besteira.</p>

<h2 id="nÃ£o-deixe-de-ler">NÃ£o deixe de ler:</h2>

<ul>
  <li><a href="https://github.com/orta/pragmatic-testing">A Pragmatic Approach to iOS Testing, do Orta Therox</a></li>
</ul>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/ios/2017/03/05/por-que-a-interface-grafica-e-um-xml/" data-toggle="tooltip" data-placement="top" title="Por que a interface grÃ¡fica Ã© um XML?">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/ios/2017/03/07/lldb-e-seu-amigo/" data-toggle="tooltip" data-placement="top" title="LLDB Ã© seu amigo">PrÃ³ximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto â€” Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
