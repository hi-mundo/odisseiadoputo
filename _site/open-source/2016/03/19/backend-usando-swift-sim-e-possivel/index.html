<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento ‚Äî artigos, tutoriais e opini√£o.">

    <title>Backend usando Swift ? Sim, √© poss√≠vel! - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/open-source/2016/03/19/backend-usando-swift-sim-e-possivel/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Backend usando Swift ? Sim, √© poss√≠vel!</h1>
                        
                        <h2 class="subheading">Entenda um pouco sobre o projeto open source que vai te ajudar a ver o desenvolvimento de software para servidores de outra forma usando Swift!</h2>
                        
                        <span class="meta">Postado por Thiago Holanda em 19/03/2016</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Backend usando Swift ? Sim, √© poss√≠vel!&url=http://localhost:4000/open-source/2016/03/19/backend-usando-swift-sim-e-possivel/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/open-source/2016/03/19/backend-usando-swift-sim-e-possivel/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/open-source/2016/03/19/backend-usando-swift-sim-e-possivel/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/open-source/2016/03/19/backend-usando-swift-sim-e-possivel/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<blockquote>
  <p>Thiago Holanda (<a href="https://twitter.com/tholanda" target="_blank">@tholanda</a>), desenvolvedor de software h√° um bocado de tempo, j√° trabalhou em tudo que foi tipo de projeto. Come√ßou no backend, se meteu a besta com banco de dados, iniciou no iOS, se embrenhou pelo client side, voltou pro iOS e agora voltou a namorar o backend, ufa‚Ä¶ Marido da Carolina, pai de duas trombadinhas felinas e quando tem um tempinho d√° uns rol√©s de skate por a√≠, que √© a terceira maior paix√£o, depois da Carolina e da programa√ß√£o!
<br /></p>
</blockquote>

<h3 id="um-pequeno-overview">Um pequeno overview</h3>

<p>Recentemente, enquanto preparava uma apresenta√ß√£o sobre <em>‚ÄúSwift no Backend‚Äù</em> para o encontro de desenvolvedores de uma grande empresa, conversei com alguns amigos no <a href="https://iosdevbr.herokuapp.com">Slack</a>, nos corredores da empresa e percebi que nos dias de hoje temos excelentes desenvolvedores m√≥veis, que por muitas vezes n√£o conhecem outras tecnologias, sen√£o <em>iOS</em> ou <em>Android</em>.</p>

<p>Pessoas que acompanharam a populariza√ß√£o dessas novas tecnologias atrav√©s da Apple e do Google, investiram tempo e dinheiro nesse segmento, e deixaram de lado o restante das engrenagens que fazem esse grande rel√≥gio chamado <a href="https://en.wikipedia.org/wiki/World_Wide_Web" target="_blank">World Wide Web</a> funcionar.</p>

<p>Eu mesmo, durante alguns anos, deixei o backend de lado e esquecido acreditando que parte de um novo futuro estava nas m√£os de empresas que estavam surgindo sob uma nova sigla: <a href="https://en.wikipedia.org/wiki/Mobile_backend_as_a_service" target="_blank">BaaS</a> <em>(Backend as a Service)</em> . Achei que o <em><a href="https://www.parse.com" target="_blank">Parse</a></em> era a grande solu√ß√£o, quase uma bala de prata. Desenvolvi alguns sistemas usando a ferramenta e n√£o posso dizer que me arrependi.</p>

<p>Depois de um tempo trilhando esse caminho, comecei a perceber qu√£o intrusivo era o <a href="https://www.parse.com" target="_blank">Parse</a>. Queria me livrar das garras dele e ent√£o renasceu a id√©ia de me dedicar mais ao backend e buscar alternativas de c√≥digo aberto, que fosse semelhante ao que o <a href="https://www.parse.com" target="_blank">Parse</a> poderia me oferecer. Nessa busca, tinha em mente algumas coisas: 1) open source, 2) <a href="https://www.swift.org" target="_blank">Swift</a>, 3) backend, e √© claro, iniciar o pr√≥ximo projeto em <a href="https://www.swift.org" target="_blank">Swift</a>.</p>

<p>Por falta de tempo ou vontade de sair da zona de conforto, esse projeto em <a href="https://www.swift.org" target="_blank">Swift</a> n√£o foi iniciado. Finalmente, no in√≠cio de Dezembro de 2015, a <em>Apple</em> libera o c√≥digo fonte do <em><a href="https://www.swift.org" target="_blank">Swift</a></em>, o que foi √≥timo. Em Janeiro, conversando com o <a href="https://twitter.com/rabc" target="_blank">Ricardo Borelli</a>, percebemos que havia uma vontade m√∫tua de aprender o <em><a href="https://www.swift.org" target="_blank">Swift</a></em>, mas n√£o para trabalhar no <em>iOS</em>. Quer√≠amos aprender a linguagem de programa√ß√£o, n√£o o <em>Framework</em>. A pergunta nesse momento, era: ‚ÄúComo?‚Äù.</p>

<p>As formas que t√≠nhamos para iniciar nosso aprendizado no <em><a href="https://www.swift.org" target="_blank">Swift</a></em> eram:</p>

<ul>
  <li>Desenvolvendo uma aplica√ß√£o iOS (fora do nosso objetivo inicial)</li>
  <li>Contribuir com projeto open source escrito em <em><a href="https://www.swift.org" target="_blank">Swift</a></em></li>
</ul>

<p>Por termos trabalhado alguns anos como desenvolvedores Backend, a segunda op√ß√£o era mais atraente, ent√£o iniciamos as buscas por projetos open source que nos permitissem desenvolver <em>web applications</em> usando <em><a href="https://www.swift.org" target="_blank">Swift</a></em>.</p>

<p>Primeiro chegamos ao <a href="https://github.com/CocoaPods/CocoaPods-app" target="_blank">CocoaPods App</a>. Desencantamos, pois era um projeto com diversas classes escritas em <em>Objective-C</em>. Em seguida, encontramos o <a href="http://www.perfect.org/" target="_blank">Perfect</a>, o <a href="https://github.com/qutheory/vapor" target="_blank">Vapor</a>, e ent√£o o <a href="https://twitter.com/rabc" target="_blank">Ricardo</a> encontrou o <a href="http://zewo.io" target="_blank">Zewo</a>. A partir da√≠ come√ßou de fato o envolvimento com um projeto 100% open source para servidor, onde aprender√≠amos <a href="https://www.swift.org" target="_blank">Swift</a>.</p>

<p><br /></p>

<h3 id="o-que-√©-o-zewo">O que √© o Zewo?</h3>

<p>O <em><a href="http://zewo.io" target="_blank">Zewo</a></em> √© um conjunto de bibliotecas voltadas para o desenvolvimento de software para servidores. Diversas bibliotecas do <em><a href="http://zewo.io" target="_blank">Zewo</a></em> s√£o nada mais do que wrappers de classes, que foram escritas em <em><a href="https://en.wikipedia.org/wiki/C_(programming_language)" target="_blank">C</a></em>.</p>

<p><br /></p>

<h3 id="a-hist√≥ria-do-zewo">A Hist√≥ria do Zewo</h3>

<p>O <em><a href="http://zewo.io" target="_blank">Zewo</a></em> nasceu em torno de Junho de 2015, na √©poca em que a <em>Apple</em> anunciou que abriria o c√≥digo fonte do <em><a href="https://www.swift.org" target="_blank">Swift</a></em>. O primeiro nome dele foi <em><a href="https://github.com/paulofaria/SwiftHTTPServer" target="_blank">SwiftHTTPServer</a></em> e foi constru√≠do pelo <em><a href="https://twitter.com/paulofaria" target="_blank">Paulo Faria</a></em> - um dev brasileiro - que manteve a constru√ß√£o do <em><a href="https://github.com/paulofaria/SwiftHTTPServer" target="_blank">SwiftHTTPServer</a></em> em constante crescimento, at√© pouco antes da <em>Apple</em> finalmente liberar o c√≥digo fonte do <em><a href="https://www.swift.org" target="_blank">Swift</a></em>, quando ele decidiu reiniciar tudo. E ent√£o surgiu o <em><a href="http://zewo.io" target="_blank">Zewo</a></em> com uma proposta diferente: ‚Äún√£o ser apenas um web framework, mas uma plataforma de desenvolvimento para tudo que fosse relacionado a servidor‚Äù. E tudo isso gra√ßas ao fato de compilar para Linux.</p>

<p><br /></p>

<h3 id="se-√©-uma-plataforma-para-servidores-me-d√°-uns-exemplos-do-que-eu-posso-fazer-com-o-zewo">Se √© uma plataforma para servidores, me d√° uns exemplos do que eu posso fazer com o Zewo.</h3>

<p>Voc√™ pode trabalhar com praticamente tudo que voc√™ quiser no servidor. 
Alguns poucos exemplos:</p>

<ul>
  <li>Crawlers</li>
  <li>Loggers</li>
  <li>Renders</li>
  <li>Database (MySQL e Postgres)</li>
  <li>Scripts</li>
  <li>Web Applications</li>
  <li>Conex√µes remotas usando TCP/UDP</li>
</ul>

<p>E o mais interessante: sem precisar da <a href="https://developer.apple.com/library/mac/documentation/Cocoa/Reference/Foundation/ObjC_classic/" target="_blank">Foundation</a>, que ainda n√£o possui o c√≥digo fonte liberado.</p>

<p><br /></p>

<h3 id="zewo--swift-x">Zewo + Swift X</h3>

<p>Desde o in√≠cio, modulariza√ß√£o foi um dos focos principais do <a href="http://zewo.io" target="_blank">Zewo</a>. Isso faz com que a reutiliza√ß√£o de c√≥digo ocorra de forma muito mais f√°cil. Quando Vapor (um dos frameworks web para swift) resolveu se integrar aos m√≥dulos do Zewo, surgiu a id√©ia de criar um padr√£o para compartilhamento de c√≥digo entre projetos Swift. Nasceu ent√£o o <a href="https://github.com/swiftx/docs" target="_blank">Swift X</a> (Swift Cross Project Standards). O <a href="https://github.com/swiftx/docs" target="_blank">Swift X</a> √© uma cole√ß√£o de protocolos e tipos b√°sicos, passando por dados bin√°rios, requisi√ß√µes e respostas <em>HTTP</em>, <em>URIs</em>, at√© alcan√ßar um padr√£o para servidores e clientes <em>HTTP</em>, roteadores <em>HTTP</em>, <em>middlewares</em>, etc.</p>

<p>O <em><a href="https://github.com/swiftx/docs" target="_blank">Swift X</a></em> ainda √© bem novo, mas j√° tem alguns frameworks iniciando o suporte a seus padr√µes. A pr√≥xima vers√£o do <em><a href="http://zewo.io" target="_blank">Zewo</a></em> j√° vai fazer uso do <em>SX</em>, facilitando ainda mais o compartilhamento de c√≥digo e integra√ß√£o entre a comunidade <em><a href="https://www.swift.org" target="_blank">Swift</a></em>.</p>

<p><br /></p>

<h3 id="vamos-come√ßar">Vamos come√ßar?</h3>

<p>Voc√™ precisa de algumas ferramentas. <em>V√¢mo</em> l√°, receita de bolo üòú:</p>

<ul>
  <li><a href="http://brew.sh">Homebrew</a></li>
  <li>Um editor de texto
    <ul>
      <li><a href="https://coderunnerapp.com" target="_blank">CodeRunner</a></li>
      <li><a href="https://www.sublimetext.com/" target="_blank">Sublime Text</a></li>
      <li><a href="https://atom.io" target="_blank">Atom</a></li>
      <li><a href="https://macromates.com/" target="_blank">TextMate</a></li>
      <li>Voc√™ n√£o manda em mim, vou usar o TextEdit üòÇ</li>
    </ul>
  </li>
</ul>

<p>Depois de instalado, ser√° necess√°rio adicionar a f√≥rmula do <em><a href="http://zewo.io" target="_blank">Zewo</a></em> para o <a href="http://brew.sh">Homebrew</a>. No <em>terminal</em>, digite o seguinte comando</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>brew tap zewo/tap
<span class="nv">$ </span>brew <span class="nb">install </span>zewo
</code></pre></div></div>
<p><br /></p>

<h3 id="toolchain">Toolchain</h3>

<p>Para iniciar os trabalhos de forma simples, usando o <em>Mac OS X</em>, precisaremos do <em>toolchain</em> do <em><a href="https://www.swift.org" target="_blank">Swift</a></em>.</p>

<blockquote>
  <p>Se voc√™ j√° tem tudo isso instalado, v√° direto para <em><a href="#criando-um-hello-world">Criando o Hello World</a></em></p>
</blockquote>

<p>Fa√ßa o download do toolchain de 08 de Fevereiro em <em><a href="https://swift.org/download/#apple-platforms" target="_blank">https://swift.org/download/#apple-platforms</a></em></p>

<p><img src="/img/tholanda/swift-download-page.png" alt="Swift Download Page" /></p>

<p>Finalizado o download, execute o <code class="language-plaintext highlighter-rouge">swift-DEVELOPMENT-SNAPSHOT-2016-02-08-a-osx.pkg</code></p>

<p>Ser√° necess√°rio que voc√™ adicione √† sua vari√°vel de ambiente, o path do toolchain que foi instalado.</p>

<p>Abra o <em>terminal</em> e digite o seguinte comando</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>open ~/.bash_profile
</code></pre></div></div>

<p>Adicione o path padr√£o de instala√ß√£o do <em><a href="https://www.swift.org" target="_blank">Swift</a></em> (caso voc√™ n√£o tenha alterado o diret√≥rio de instala√ß√£o)</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/Library/Developer/Toolchains/swift-latest.xctoolchain/usr/bin
</code></pre></div></div>

<p>O resultado final da vari√°vel de ambiente <em>PATH</em> dever√° ser algo semelhante ao screenshot. Salve a modifica√ß√£o no <em>.bash_profile</em>.</p>

<p><img src="/img/tholanda/environment-variable-path-textedit.png" alt="" /></p>

<p>Feito isso, ser√° necess√°rio executar o <em>.bash_profile</em>, usando o comando abaixo</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">source</span> ~/.bash_profile
</code></pre></div></div>
<p><br /></p>

<h3 id="criando-um-hello-world">Criando um Hello World</h3>

<p>Vamos voltar ao <em>terminal</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/
<span class="nv">$ </span><span class="nb">mkdir </span>hello-world
<span class="nv">$ </span><span class="nb">cd </span>hello-world
<span class="nv">$ </span>swift-build <span class="nt">--init</span>
Creating Package.swift
Creating .gitignore
Creating Sources/
Creating Sources/main.swift
Creating Tests/
</code></pre></div></div>

<p>Com um editor de texto, edite o arquivo <em>Package.swift</em> e adicione os reposit√≥rios <a href="https://github.com/Zewo/HTTPServer" target="_blank">HTTPServer</a>, <a href="https://github.com/Zewo/Router" target="_blank">Router</a> e <a href="https://github.com/Zewo/LogMiddleware" target="_blank">LogMiddleware</a> √† nossa lista de depend√™ncias</p>

<p><em>Package.swift</em></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">PackageDescription</span>

<span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
    <span class="nv">name</span><span class="p">:</span> <span class="s">"hello-world"</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/HTTPServer.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">),</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/Router.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">),</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/LogMiddleware.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div></div>

<p><em>Sources/main.swift</em></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">HTTPServer</span>
<span class="kd">import</span> <span class="kt">Router</span>
<span class="kd">import</span> <span class="kt">LogMiddleware</span>

<span class="k">let</span> <span class="nv">log</span> <span class="o">=</span> <span class="kt">Log</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">logMiddleware</span> <span class="o">=</span> <span class="kt">LogMiddleware</span><span class="p">(</span><span class="nv">log</span><span class="p">:</span> <span class="n">log</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">router</span> <span class="o">=</span> <span class="kt">Router</span><span class="p">(</span><span class="nv">middleware</span><span class="p">:</span> <span class="n">logMiddleware</span><span class="p">)</span> <span class="p">{</span> <span class="n">route</span> <span class="k">in</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">body</span><span class="p">:</span> <span class="s">"Hello World!"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">try</span> <span class="kt">Server</span><span class="p">(</span><span class="nv">port</span><span class="p">:</span> <span class="mi">8080</span><span class="p">,</span> <span class="nv">responder</span><span class="p">:</span> <span class="n">router</span><span class="p">)</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
</code></pre></div></div>

<p>Ap√≥s implementar essas <del>milhares</del> poucas linhas de c√≥digo volte ao <em>terminal</em>, no diret√≥rio do projeto, e execute o compilador do <em><a href="https://www.swift.org" target="_blank">Swift</a></em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>swift-build
</code></pre></div></div>

<p>Na primeira vez que voc√™ executar o <code class="language-plaintext highlighter-rouge">swift-build</code> no diret√≥rio do seu projeto, o <em><a href="https://github.com/apple/swift-package-manager" target="_blank">Swift Package Manager</a></em> far√° o clone dos projetos que adicionamos na chave <code class="language-plaintext highlighter-rouge">dependencies</code>, no <code class="language-plaintext highlighter-rouge">Package.swift</code> e suas subdepend√™ncias, em seguida os sources ser√£o compilados. Por fim, o resultado ser√° um execut√°vel gerado pelo compilador</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>swift-build
Compiling Swift Module <span class="s1">'helloworld'</span> <span class="o">(</span>1 sources<span class="o">)</span>
Linking Executable:  .build/debug/hello-world
</code></pre></div></div>

<p>Agora que o compilador disse pra gente o que compilou e onde gerou o execut√°vel, fica f√°cil saber o que executar.</p>

<p>Assumindo que voc√™ est√° no diret√≥rio <code class="language-plaintext highlighter-rouge">hello-world</code>, digite o seguinte no <em>terminal</em></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>.build/debug/hello-world



                             _____
     ,.-<span class="sb">``</span>-._.-<span class="sb">``</span>-.,        /__  /  ___ _      ______
    |<span class="sb">`</span>-._,.-<span class="sb">`</span>-.,_.-<span class="sb">`</span>|         / /  / _ <span class="se">\ </span>| /| / / __ <span class="se">\</span>
    |   |ÀÜ-. .-<span class="sb">`</span>|   |        / /__/  __/ |/ |/ / /_/ /
    <span class="sb">`</span>-.,|   |   |,.-<span class="sb">`</span>       /____/<span class="se">\_</span>__/|__/|__/<span class="se">\_</span>___/ <span class="o">(</span>c<span class="o">)</span>
        <span class="sb">`</span>-.,|,.-<span class="sb">`</span>           <span class="nt">-----------------------------</span>

<span class="o">================================================================================</span>
Started HTTP server, listening on port 8080.
</code></pre></div></div>

<p>Agora que temos o nosso servidor rodando devidamente no <em>terminal</em>, abra o browser e digite a seguinte URL: <code class="language-plaintext highlighter-rouge">http://127.0.0.1:8080</code> e voc√™ ver√° algo como o screeshot abaixo</p>

<p><img src="/img/tholanda/hello-world-running-on-browser.png" alt="" /></p>

<p>Por ter configurado  o <a href="https://github.com/Zewo/LogMiddleware" target="_blank">LogMiddleware</a> no <code class="language-plaintext highlighter-rouge">Package.swift</code>, as requisi√ß√µes disparadas contra o servidor ser√£o mostradas no console.</p>

<blockquote>
  <p>Em diversos web frameworks, mostrar os detalhes da requisi√ß√£o no console √© parte da configura√ß√£o padr√£o. Como no <em><a href="http://zewo.io" target="_blank">Zewo</a></em> separamos todos os m√≥dulos, deixamos essa configura√ß√£o como op√ß√£o para o usu√°rio. No <em>Hello World</em> n√£o estamos persistindo esses dados, mas caso seja interessante, voc√™ pode usar o <a href="https://github.com/Zewo/File" target="_blank">File</a> para guard√°-los em um arquivo.</p>
</blockquote>

<p><img src="/img/tholanda/hello-world-showing-log-on-console.png" alt="" /></p>

<p>Enfim, depois de tanta explica√ß√£o, esse √© o nosso <em>Hello World</em> usando <em><a href="https://www.swift.org" target="_blank">Swift</a></em> e <em><a href="http://zewo.io" target="_blank">Zewo</a></em>. 
Por que n√£o incrementar um pouco mais esse exemplo ? Fique tranquilo que a partir de agora n√£o serei t√£o detalhista! <del>ser√°?</del> üòå</p>

<p><br /></p>

<h3 id="criando-um-render-html">Criando um render html</h3>

<p>Legal, bacana, temos o <em>Hello World</em> funcionando. Mas se estamos falando sobre montar uma <em>web application</em>, ent√£o √© necess√°rio renderizar um <em>HTML</em> com informa√ß√µes vindas do sevidor, n√£o √© mesmo ? Por isso, vamos usar o <a href="https://github.com/Zewo/Sideburns" target="_blank">Sideburns</a> <em>- uma pequena camada sobre o <a href="https://github.com/Zewo/Mustache" target="_blank">Mustache</a> que √© um fork do <a href="https://github.com/groue/GRMustache.swift" target="_blank">GRMustache</a> -</em> e o <a href="https://github.com/Zewo/HTTPFile" target="_blank">HTTPFile</a> que √© a implementa√ß√£o do protocolo <em>ResponderType</em> e ser√° usado para expor o conte√∫do da pasta <code class="language-plaintext highlighter-rouge">public</code>.</p>

<p>Ao adicionar o <a href="https://github.com/Zewo/Sideburns" target="_blank">Sideburns</a> √† lista de <code class="language-plaintext highlighter-rouge">dependencies</code>, o<code class="language-plaintext highlighter-rouge">Package.swift</code> dever√° ficar assim</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">PackageDescription</span>

<span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
    <span class="nv">name</span><span class="p">:</span> <span class="s">"hello-world"</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/HTTPServer.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">),</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/Router.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">),</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/LogMiddleware.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">),</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/HTTPFile.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">),</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/Sideburns.git"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div></div>

<p>Show! Logo ap√≥s adicionar os novos pacotes, o ideal seria voltar ao <em>terminal</em> e rodar o <code class="language-plaintext highlighter-rouge">swift-build</code>, mas podemos esperar um pouquinho mais e fazer tudo de uma vez.
Mas se paci√™ncia n√£o for muito seu forte, manda ver! Mal n√£o vai fazer! üòú</p>

<p>Na raiz do seu projeto vamos criar uma pasta chamada <code class="language-plaintext highlighter-rouge">public</code> e vamos adicionar alguns arquivos simples. No <em>terminal</em> digite</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">mkdir</span> <span class="nt">-p</span> public/assets
</code></pre></div></div>

<p>crie um arquivo <code class="language-plaintext highlighter-rouge">main.css</code> dentro da pasta <code class="language-plaintext highlighter-rouge">assets</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">touch </span>public/assets/main.css
</code></pre></div></div>

<p>edite o <code class="language-plaintext highlighter-rouge">main.css</code> e vamos adicionar uma simples propriedade, apenas para que a nossa p√°gina n√£o fique completamente sem estilo</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">body</span> <span class="p">{</span>
    <span class="nl">font-family</span><span class="p">:</span> <span class="s1">"verdana"</span><span class="p">;</span>
    <span class="nl">font-size</span><span class="p">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>
<p>crie na raiz da pasta <code class="language-plaintext highlighter-rouge">public</code> um arquivo chamado <code class="language-plaintext highlighter-rouge">hello.html</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">touch </span>public/hello.html
</code></pre></div></div>

<p>edite o <code class="language-plaintext highlighter-rouge">hello.html</code> e adicione o seguinte bloco ao arquivo</p>

<blockquote>
  <p>caso voc√™ tenha d√∫vidas sobre a forma de trabalhar com o <em>Mustache</em>, acesse a documenta√ß√£o da ferramenta no link <a href="https://github.com/groue/GRMustache" target="_blank">https://github.com/groue/GRMustache</a>.</p>
</blockquote>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>{{ title }}<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"/assets/main.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            <span class="nt">&lt;h1&gt;</span>
            {{ description }}
            <span class="nt">&lt;/h1&gt;</span>
            <span class="nt">&lt;ul&gt;</span>
                {{# messages }}
                <span class="nt">&lt;li&gt;</span> {{ author }} - {{ message }} <span class="nt">&lt;/li&gt;</span>
                {{/ messages }}
            <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>O que adicionaremos agora ao nosso <code class="language-plaintext highlighter-rouge">Sources/main.swift</code>:</p>

<ul>
  <li>Estrutura de dados para ser renderizado no <code class="language-plaintext highlighter-rouge">html</code>, que ser√° o response do endpoint ‚Äú/‚Äù</li>
  <li>Response com path do arquivo que ser√° usado para renderizar o dicion√°rio que acabamos de adicionar</li>
  <li><code class="language-plaintext highlighter-rouge">FileResponder</code>, que ser√° respons√°vel por expor os arquivos da pasta <code class="language-plaintext highlighter-rouge">public</code> de forma est√°tica</li>
</ul>

<p>O resultado final do nosso <code class="language-plaintext highlighter-rouge">main.swift</code></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">HTTPServer</span>
<span class="kd">import</span> <span class="kt">Router</span>
<span class="kd">import</span> <span class="kt">LogMiddleware</span>
<span class="kd">import</span> <span class="kt">HTTPFile</span>
<span class="kd">import</span> <span class="kt">Mustache</span>
<span class="kd">import</span> <span class="kt">Sideburns</span>

<span class="k">let</span> <span class="nv">log</span> <span class="o">=</span> <span class="kt">Log</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">logMiddleware</span> <span class="o">=</span> <span class="kt">LogMiddleware</span><span class="p">(</span><span class="nv">log</span><span class="p">:</span> <span class="n">log</span><span class="p">)</span>

<span class="k">let</span> <span class="nv">router</span> <span class="o">=</span> <span class="kt">Router</span><span class="p">(</span><span class="nv">middleware</span><span class="p">:</span> <span class="n">logMiddleware</span><span class="p">)</span> <span class="p">{</span> <span class="n">route</span> <span class="k">in</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">get</span><span class="p">(</span><span class="s">"/"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">data</span><span class="p">:</span> <span class="p">[</span><span class="kt">String</span><span class="p">:</span> <span class="kt">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">"title"</span><span class="p">:</span> <span class="s">"T√≠tulo da P√°gina"</span><span class="p">,</span>
            <span class="s">"description"</span><span class="p">:</span> <span class="s">"Renderizando HTML usando Sideburns"</span><span class="p">,</span>
            <span class="s">"messages"</span><span class="p">:</span> <span class="p">[</span> 
                <span class="p">[</span>
                    <span class="s">"author"</span><span class="p">:</span> <span class="s">"Patrick"</span><span class="p">,</span> 
                    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Lorem ipsum dolor sit amet, consectetur adipiscing elit."</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="s">"author"</span><span class="p">:</span> <span class="s">"Senhor Sirigueijo"</span><span class="p">,</span> 
                    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Morbi luctus urna vel lacus malesuada posuere."</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="s">"author"</span><span class="p">:</span> <span class="s">"Lula Molusco"</span><span class="p">,</span> 
                    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Praesent dignissim nunc a convallis posuere."</span>
                <span class="p">],</span>
                <span class="p">[</span>
                    <span class="s">"author"</span><span class="p">:</span> <span class="s">"Bob Esponja"</span><span class="p">,</span> 
                    <span class="s">"message"</span><span class="p">:</span> <span class="s">"Nam facilisis arcu at consequat sagittis."</span>
                <span class="p">]</span>
            <span class="p">]</span>
        <span class="p">]</span>
        <span class="k">return</span> <span class="k">try</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">templatePath</span><span class="p">:</span> <span class="s">"public/hello.html"</span><span class="p">,</span> <span class="nv">templateData</span><span class="p">:</span> <span class="n">data</span><span class="p">)</span>
    <span class="p">}</span>
    <span class="n">route</span><span class="o">.</span><span class="n">fallback</span> <span class="o">=</span> <span class="kt">FileResponder</span><span class="p">(</span><span class="nv">basePath</span><span class="p">:</span> <span class="s">"public"</span><span class="p">)</span>
<span class="p">}</span>

<span class="k">try</span> <span class="kt">Server</span><span class="p">(</span><span class="nv">port</span><span class="p">:</span> <span class="mi">8080</span><span class="p">,</span> <span class="nv">responder</span><span class="p">:</span> <span class="n">router</span><span class="p">)</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
</code></pre></div></div>

<p>Ok, terminamos de incrementar o nosso <em>Hello World</em> com a renderiza√ß√£o de algumas informa√ß√µes do servidor. Nesse caso, os dados est√£o todos <em>‚Äúmockados‚Äù</em>, mas poderiam vir diretamente de um banco (que √© assunto para um pr√≥ximo artigo üòâ). Agora vamos compilar as nossas mudan√ßas e executar o bin√°rio gerado pelo compilador. Para isso, volte ao <em>terminal</em> e execute</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>swift-build
<span class="nv">$ </span>.build/debug/hello-world
</code></pre></div></div>

<p>Abra o browser e digite o endere√ßo <code class="language-plaintext highlighter-rouge">http://127.0.0.1:8080</code>. Ao carregar a tela, esse deve ser o resultado</p>

<p><img src="/img/tholanda/beautiful-rendering-browser.png" alt="" /></p>

<p>e o <code class="language-plaintext highlighter-rouge">html</code> ser√° parecido com que est√° listado abaixo</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>T√≠tulo da P√°gina<span class="nt">&lt;/title&gt;</span>
        <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"stylesheet"</span> <span class="na">type=</span><span class="s">"text/css"</span> <span class="na">href=</span><span class="s">"/assets/main.css"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            <span class="nt">&lt;h1&gt;</span>
            Renderizando HTML usando Sideburns
            <span class="nt">&lt;/h1&gt;</span>
            <span class="nt">&lt;ul&gt;</span>
                <span class="nt">&lt;li&gt;</span> Patrick - Lorem ipsum dolor sit amet, consectetur adipiscing elit. <span class="nt">&lt;/li&gt;</span>
                <span class="nt">&lt;li&gt;</span> Senhor Sirigueijo - Morbi luctus urna vel lacus malesuada posuere. <span class="nt">&lt;/li&gt;</span>
                <span class="nt">&lt;li&gt;</span> Lula Molusco - Praesent dignissim nunc a convallis posuere. <span class="nt">&lt;/li&gt;</span>
                <span class="nt">&lt;li&gt;</span> Bob Esponja - Nam facilisis arcu at consequat sagittis. <span class="nt">&lt;/li&gt;</span>
            <span class="nt">&lt;/ul&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<p>e por aqui, finalizamos mais um exemplo de como podemos renderizar valores em um <code class="language-plaintext highlighter-rouge">html</code>.</p>

<p><br /></p>

<h3 id="criando-uma-api-simples">Criando uma API simples</h3>

<p>Agora, vamos usar um reposit√≥rio que j√° tem como depend√™ncia diversos outros que precisamos para <em>web applications</em> - o <a href="https://github.com/Zewo/Zewo" target="_blank">Zewo</a> - um reposit√≥rio que podemos chamar de <em>umbrella package</em>, fazendo uma refer√™ncia a <a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPFrameworks/Tasks/IncludingFrameworks.html" target="_blank">umbrella header</a>.</p>

<blockquote>
  <p>Por conta de diversas libraries ainda estarem sendo escritas, principalmente no caso de rotas RESTful, nesse artigo veremos apenas as rotas de consulta mais simples. Em breve escreverei outro post abordando APIs mais complexas, prometo üòâüôè!</p>
</blockquote>

<p>Nesse exemplo criaremos uma API ridiculamente simples. O objetivo n√£o √© ser complexo e por isso n√£o faria sentido criar muitos m√©todos.</p>

<p>Ent√£o vamos come√ßar criando um novo pacote para a nossa API ? De volta ao <em>terminal</em> crie uma nova pasta com o nome <code class="language-plaintext highlighter-rouge">todo-api</code></p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span><span class="nb">cd</span> ~/
<span class="nv">$ </span><span class="nb">mkdir </span>todo-api
<span class="nv">$ </span><span class="nb">cd </span>todo-api
<span class="nv">$ </span>swift-build <span class="nt">--init</span>
Creating Package.swift
Creating .gitignore
Creating Sources/
Creating Sources/main.swift
Creating Tests/
</code></pre></div></div>

<p>vamos editar o arquivo <code class="language-plaintext highlighter-rouge">Package.swift</code> e adicionar a √∫nica depend√™ncia que precisaremos, o <a href="https://github.com/Zewo/Zewo" target="_blank">Zewo</a></p>

<blockquote>
  <p>Se voc√™ quiser conhecer quais s√£o as depend√™ncias usadas por esse reposit√≥rio, acesse essa url: <a href="https://github.com/Zewo/Zewo/blob/master/Package.swift" target="_blank">https://github.com/Zewo/Zewo/blob/master/Package.swift</a></p>
</blockquote>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">PackageDescription</span>

<span class="k">let</span> <span class="nv">package</span> <span class="o">=</span> <span class="kt">Package</span><span class="p">(</span>
    <span class="nv">name</span><span class="p">:</span> <span class="s">"todo-api"</span><span class="p">,</span>
    <span class="nv">dependencies</span><span class="p">:</span> <span class="p">[</span>
        <span class="o">.</span><span class="kt">Package</span><span class="p">(</span><span class="nv">url</span><span class="p">:</span> <span class="s">"https://github.com/Zewo/Zewo"</span><span class="p">,</span> <span class="nv">majorVersion</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="nv">minor</span><span class="p">:</span> <span class="mi">3</span><span class="p">)</span>
    <span class="p">]</span>
<span class="p">)</span>
</code></pre></div></div>

<p>agora n√≥s precisamos criar de fato as nossas rotas e respostas, sendo assim, edite o arquivo <code class="language-plaintext highlighter-rouge">Sources/main.swift</code> e cole o conte√∫do do bloco abaixo</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">HTTPServer</span>
<span class="kd">import</span> <span class="kt">Router</span>
<span class="kd">import</span> <span class="kt">LogMiddleware</span>
<span class="kd">import</span> <span class="kt">HTTPFile</span>
<span class="kd">import</span> <span class="kt">ContentNegotiationMiddleware</span>
<span class="kd">import</span> <span class="kt">LogMiddleware</span>
<span class="kd">import</span> <span class="kt">JSONMediaType</span>
<span class="kd">import</span> <span class="kt">InterchangeData</span>

<span class="k">let</span> <span class="nv">log</span>                 <span class="o">=</span> <span class="kt">Log</span><span class="p">()</span>
<span class="k">let</span> <span class="nv">logMiddleware</span>       <span class="o">=</span> <span class="kt">LogMiddleware</span><span class="p">(</span><span class="nv">log</span><span class="p">:</span> <span class="n">log</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">contentNegotiaton</span>   <span class="o">=</span> <span class="kt">ContentNegotiationMiddleware</span><span class="p">(</span><span class="nv">mediaTypes</span><span class="p">:</span> <span class="kt">JSONMediaType</span><span class="p">())</span>

<span class="k">let</span> <span class="nv">router</span> <span class="o">=</span> <span class="kt">Router</span><span class="p">(</span><span class="nv">middleware</span><span class="p">:</span> <span class="n">logMiddleware</span><span class="p">,</span> <span class="n">contentNegotiaton</span><span class="p">)</span> <span class="p">{</span> <span class="n">route</span> <span class="k">in</span>
    
    <span class="k">var</span> <span class="nv">items</span><span class="p">:</span> <span class="p">[</span><span class="kt">InterchangeData</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"id"</span><span class="p">:</span> <span class="s">"1"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"Comprar frutas"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"id"</span><span class="p">:</span> <span class="s">"5"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"Pagar condom√≠nio"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"id"</span><span class="p">:</span> <span class="s">"3"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"Despachar encomenda"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"id"</span><span class="p">:</span> <span class="s">"6"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"Assistir Deadpool"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"id"</span><span class="p">:</span> <span class="s">"4"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"Ir ao banco"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"id"</span><span class="p">:</span> <span class="s">"2"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"Ligar para operadora"</span><span class="p">]</span>
    <span class="p">]</span>
    
    <span class="kd">func</span> <span class="nf">get</span><span class="p">(</span><span class="nv">id</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="k">throws</span> <span class="o">-&gt;</span> <span class="kt">InterchangeData</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">list</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="nf">filter</span><span class="p">({</span> <span class="nv">$0</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">!.</span><span class="n">string</span> <span class="o">==</span> <span class="n">id</span> <span class="p">})</span>

        <span class="k">guard</span> <span class="k">let</span> <span class="nv">todo</span> <span class="o">=</span> <span class="n">list</span><span class="o">.</span><span class="n">first</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">nil</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="n">todo</span>
    <span class="p">}</span>
    
    <span class="c1">// cria o novo registro de uma tarefa</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">post</span><span class="p">(</span><span class="s">"/todo"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">body</span>        <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">content</span><span class="o">!</span>
        
        <span class="k">let</span> <span class="nv">id</span>          <span class="o">=</span> <span class="kt">InterchangeData</span><span class="o">.</span><span class="nf">from</span><span class="p">(</span><span class="kt">String</span><span class="p">(</span><span class="nf">arc4random</span><span class="p">()))</span>
        <span class="k">let</span> <span class="nv">description</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s">"description"</span><span class="p">]</span>
        
        <span class="k">let</span> <span class="nv">todo</span><span class="p">:</span> <span class="kt">InterchangeData</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s">"id"</span>          <span class="p">:</span> <span class="n">id</span><span class="p">,</span>
            <span class="s">"description"</span> <span class="p">:</span> <span class="n">description</span><span class="o">!</span>
        <span class="p">]</span>
        
        <span class="n">items</span><span class="o">.</span><span class="nf">append</span><span class="p">(</span><span class="n">todo</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">Created</span><span class="p">,</span> <span class="nv">content</span><span class="p">:</span> <span class="n">todo</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// Lista todas os registros de tarefas</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">get</span><span class="p">(</span><span class="s">"/todo"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="nf">sort</span><span class="p">({</span> <span class="nv">$0</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">!.</span><span class="n">string</span> <span class="o">&lt;</span> <span class="nv">$1</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">!.</span><span class="n">string</span> <span class="p">})</span>
        
        <span class="k">guard</span> <span class="n">items</span><span class="o">.</span><span class="n">count</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NoContent</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">content</span><span class="p">:</span> <span class="kt">InterchangeData</span><span class="o">.</span><span class="nf">from</span><span class="p">(</span><span class="n">items</span><span class="p">))</span>
    <span class="p">}</span>
    
    <span class="c1">// busca os dados de uma tarefa baseado no id</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">get</span><span class="p">(</span><span class="s">"/todo/:id"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">pathParameters</span>
        
        <span class="k">let</span> <span class="nv">todo</span> <span class="o">=</span> <span class="k">try</span> <span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
        <span class="k">guard</span> <span class="n">todo</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NotFound</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">content</span><span class="p">:</span> <span class="n">todo</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// atualiza uma tarefa baseado no id</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">put</span><span class="p">(</span><span class="s">"/todo/:id"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">pathParameters</span>
        <span class="k">let</span> <span class="nv">body</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">content</span><span class="o">!</span>
        
        <span class="k">var</span> <span class="nv">todo</span> <span class="o">=</span> <span class="k">try</span> <span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
        <span class="k">guard</span> <span class="n">todo</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NotFound</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">let</span> <span class="nv">index</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="n">todo</span><span class="p">)</span><span class="o">!</span>
        <span class="n">todo</span><span class="p">[</span><span class="s">"description"</span><span class="p">]</span> <span class="o">=</span> <span class="n">body</span><span class="p">[</span><span class="s">"description"</span><span class="p">]</span>
        <span class="n">items</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">todo</span>
        
        <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NoContent</span><span class="p">)</span>
    <span class="p">}</span>
    
    <span class="c1">// exclui uma tarefa baseado no id</span>
    <span class="n">route</span><span class="o">.</span><span class="nf">delete</span><span class="p">(</span><span class="s">"/todo/:id"</span><span class="p">)</span> <span class="p">{</span> <span class="n">request</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">path</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">pathParameters</span>
        
        <span class="k">let</span> <span class="nv">todo</span> <span class="o">=</span> <span class="k">try</span> <span class="nf">get</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="s">"id"</span><span class="p">]</span><span class="o">!</span><span class="p">)</span>
        <span class="k">guard</span> <span class="n">todo</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NotFound</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">let</span> <span class="nv">index</span> <span class="o">=</span> <span class="n">items</span><span class="o">.</span><span class="nf">indexOf</span><span class="p">(</span><span class="n">todo</span><span class="p">)</span><span class="o">!</span>
        <span class="k">guard</span> <span class="n">items</span><span class="o">.</span><span class="nf">removeAtIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NotFound</span><span class="p">)</span>
        <span class="p">}</span>
        
        <span class="k">return</span> <span class="kt">Response</span><span class="p">(</span><span class="nv">status</span><span class="p">:</span> <span class="o">.</span><span class="kt">NoContent</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">try</span> <span class="kt">Server</span><span class="p">(</span><span class="nv">port</span><span class="p">:</span> <span class="mi">8080</span><span class="p">,</span> <span class="nv">responder</span><span class="p">:</span> <span class="n">router</span><span class="p">)</span><span class="o">.</span><span class="nf">start</span><span class="p">()</span>
</code></pre></div></div>

<p>√â claro que voc√™, um expert em Swift, pode criticar diversos pontos do bloco acima, infelizmente ainda n√£o fa√ßo parte desse <del>seleto</del> time, mas estamos √† caminho.</p>

<p>Neste exemplo, criamos:</p>

<ul>
  <li>Cria√ß√£o de uma tarefa</li>
  <li>Listagem das tarefas</li>
  <li>Detalhe de uma tarefa</li>
  <li>Atualiza√ß√£o de uma tarefa</li>
  <li>Exclus√£o de uma tarefa</li>
</ul>

<p>Em princ√≠pio, para que n√£o ficasse com mais depend√™ncias (ex: banco de dados), usamos um array mut√°vel para persistir e listar as tarefas. √â claro que essa n√£o chega nem a ser uma forma decente de persist√™ncia, mas atende ao nosso prop√≥sito educativo.</p>

<blockquote>
  <p><strong>ContentNegotiationMiddleware</strong></p>

  <p>Esse middleware tem como fun√ß√£o b√°sica o tratamento do tipo de informa√ß√£o recebida no request. √â baseado no <code class="language-plaintext highlighter-rouge">Content-Type</code> e no <code class="language-plaintext highlighter-rouge">Accept</code>. No nosso exemplo, trabalharemos apenas com <code class="language-plaintext highlighter-rouge">JSON</code>. Caso haja necessidade, voc√™ pode optar por usar o <a href="https://github.com/Zewo/URLEncodedForm" target="_blank">URLEncodedForm</a>.</p>
</blockquote>

<p>Depois de rodar o exemplo anterior, voc√™ pode estar perguntando: <em>como proteger a nossa humilde API ?</em> Bom, temos √† disposi√ß√£o diversas ferramentas para nos auxiliar nesse ponto, mas por enquanto, apenas um est√° implementado de forma nativa no <a href="https://github.com/Zewo" target="_blank">Zewo</a>: o <a href="https://github.com/Zewo/BasicAuthMiddleware" target="_blank">BasicAuthMiddleware</a> <a href="https://tools.ietf.org/html/rfc2617" target="_blank">(RFC 2617)</a>.</p>

<p>Infelizmente, o <a href="https://tools.ietf.org/html/rfc2617" target="_blank">HTTP Basic Authentication</a> n√£o √© seguro em rela√ß√£o ao dado trafegado. Encriptar os dados requer <em><a href="https://en.wikipedia.org/wiki/Base64" target="_blank">Base64</a></em>, uma encripta√ß√£o de duas vias, ou seja, a seguran√ßa √© t√£o fraca que, qualquer pessoa que interceptar a sua conex√£o com o servidor, facilmente descobrir√° qual usu√°rio e senha est√° sendo transmitido. Se voc√™ usa <em>HTTPS</em>, a vida de quem est√° tentando interceptar os dados trafegados complica um pouco mais.</p>

<p><br /></p>

<h3 id="como-adicionar-o-basicauth-nas-minhas-rotas-">Como adicionar o BasicAuth nas minhas rotas ?</h3>

<p>Em outras ocasi√µes, voc√™ precisaria adicionar o pacote <em><a href="https://github.com/Zewo/BasicAuthMiddleware" target="_blank">BasicAuthMiddleware</a></em> na lista de depend√™ncias do <code class="language-plaintext highlighter-rouge">Package.swift</code>, mas n√≥s estamos usando o <a href="https://github.com/Zewo/Zewo" target="_blank">Zewo</a>, que √© o nosso <em>umbrella package</em> e ele j√° possui essa depend√™ncia. Ent√£o, ao inv√©s de trabalhar com diversas depend√™ncias, n√≥s vamos voltar a editar o <code class="language-plaintext highlighter-rouge">Sources/main.swift</code>.</p>

<p>Importe o <code class="language-plaintext highlighter-rouge">BasicAuthMiddleware</code> no topo do <code class="language-plaintext highlighter-rouge">main.swift</code></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">BasicAuthMiddleware</span>
</code></pre></div></div>

<p>vamos instanciar o <code class="language-plaintext highlighter-rouge">BasicAuthMiddleware</code></p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">basicAuth</span> <span class="o">=</span> <span class="kt">BasicAuthMiddleware</span> <span class="p">{</span> <span class="n">username</span><span class="p">,</span> <span class="n">password</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="s">"admin"</span> <span class="o">&amp;&amp;</span> <span class="n">password</span> <span class="o">==</span> <span class="s">"password"</span> <span class="p">{</span>
        <span class="k">return</span> <span class="o">.</span><span class="kt">Authenticated</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="o">.</span><span class="kt">AccessDenied</span>
<span class="p">}</span>
</code></pre></div></div>

<p>e configurar no nosso <code class="language-plaintext highlighter-rouge">Router</code>. Basta adicionar a vari√°vel <code class="language-plaintext highlighter-rouge">basicAuth</code> ao par√¢metro <code class="language-plaintext highlighter-rouge">middleware</code> e deve ficar assim</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">router</span> <span class="o">=</span> <span class="kt">Router</span><span class="p">(</span><span class="nv">middleware</span><span class="p">:</span> <span class="n">logMiddleware</span><span class="p">,</span> <span class="n">contentNegotiaton</span><span class="p">,</span> <span class="n">basicAuth</span><span class="p">)</span> <span class="p">{</span> <span class="n">route</span> <span class="k">in</span> 
</code></pre></div></div>

<p>O que precis√°vamos para ‚Äúsegurar‚Äù a nossa API era basicamente esses dois passos. O resultado disso √© simples: se voc√™ n√£o informar as credenciais no momento da requisi√ß√£o, a API recusar√° o seu acesso.</p>

<p><img src="/img/tholanda/api-secured-without-credentials.png" alt="" /></p>

<p>Ao informar credenciais v√°lidas, a API devolver√° os dados normalmente √© efetuar√° as devidas a√ß√µes, como: insert, update, delete e quantos mais voc√™ configurar</p>

<p><img src="/img/tholanda/api-secured-with-credentials.png" alt="" /></p>

<p>e finalmente, terminamos por aqui o terceiro e √∫ltimo exemplo do nosso artigo.</p>

<p><br /></p>

<h3 id="considera√ß√µes-finais">Considera√ß√µes finais</h3>

<p>Como voc√™ pode ver, o desenvolvimento de <em>web applications</em> n√£o √© realmente um monstro de sete cabe√ßas como talvez voc√™ estivesse imaginando. √â claro que no desenvolvimento de software tudo pode piorar, e pode apostar que vai. Com um pouco de estudo, dedica√ß√£o, fonte de pesquisa (t√° bom, Stack Overflow vale tamb√©m üòõ) e uma boa documenta√ß√£o, voc√™ pode e DEVE ir longe.</p>

<p>Durante o tempo em que estive escrevendo esse post, a <em>Apple</em> liberou mais um <em>toolchain</em> com diversas novas possibilidades que, com toda certeza, nos ajudar√£o muito daqui pra frente. Pelo fato de agora o <a href="https://www.swift.org" target="_blank">Swift</a> tamb√©m compilar <em><a href="https://en.wikipedia.org/wiki/C_(programming_language)" target="_blank">C</a></em>, podemos fazer deploy das aplica√ß√µes escritas em <a href="https://www.swift.org" target="_blank">Swift</a> para o <a href="https://www.heroku.com" target="_blank">Heroku</a>, mas isso tamb√©m ficar√° para uma pr√≥xima vez.</p>

<p>Os c√≥digos dos exemplos est√£o todos no meu perfil do Github, na url <a href="https://github.com/unnamedd/equinocios-backend" target="_blank">https://github.com/unnamedd/equinocios-backend</a></p>

<p>Hoje, dia 20 de Mar√ßo, seria o nosso √∫ltimo dia de <a href="http://equinocios.com" target="_blank">EquinociOS</a>, mas devido a tantos √≥timos desenvolvedores se interessarem pelo projeto, foi decidido que prorrogar√≠amos at√© o final do m√™s. Isso quer dizer que at√© o dia 31 de Mar√ßo, voc√™ vai poder acompanhar artigos in√©ditos sobre o mundo de desenvolvimento da <em>Apple</em>.</p>

<p><br /><br /></p>

<p>Esse post teve a participa√ß√£o direta de diversos amigos, sugerindo, corrigindo ou ensinando.</p>

<p>Meus agradecimentos ao <em><a href="https://twitter.com/paulofaria" target="_blank">Paulo Faria</a></em>, ao <em><a href="https://twitter.com/rabc" target="_blank">Ricardo Borelli</a></em> e a minha amada Carolina.</p>

<blockquote>
  <p>A foto de capa √© da Via L√°ctea numa bel√≠ssima noite!</p>
</blockquote>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/devlife/2016/03/18/a-vida-de-um-desenvolvedor-indie/" data-toggle="tooltip" data-placement="top" title="A vida de um desenvolvedor indie">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/ios/2016/03/20/visual-format/" data-toggle="tooltip" data-placement="top" title="Auto Layout com Visual Format">Pr√≥ximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto ‚Äî Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
