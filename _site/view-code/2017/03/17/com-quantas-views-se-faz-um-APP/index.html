<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Blog de tecnologia e desenvolvimento — artigos, tutoriais e opinião.">

    <title>Com quantas views se faz uma APP? - A odisseia do puto</title>

    <link rel="canonical" href="http://localhost:4000/view-code/2017/03/17/com-quantas-views-se-faz-um-APP/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">
    <link rel="stylesheet" href="/css/odisseia.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
    
    <!-- Share CSS -->
    <link rel="stylesheet" href="/css/share.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="A odisseia do puto" />

    

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">A odisseia do puto</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
				
                <li>
                    <a href="/about/">Sobre</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header">
    <div class="intro-header-overlay">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Com quantas views se faz uma APP?</h1>
                        
                        <h2 class="subheading">Com view code e criatividade esse número pode ser menor do que você pensa</h2>
                        
                        <span class="meta">Postado por Ronan Rodrigo Nunes em 17/03/2017</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="share">
  <li><a href="https://twitter.com/intent/tweet?text=Com quantas views se faz uma APP?&url=http://localhost:4000/view-code/2017/03/17/com-quantas-views-se-faz-um-APP/" rel="nofollow" target="_blank" title="Share on Twitter"><i class="fa fa-twitter-square"></i></a></li>
  <li><a href="https://facebook.com/sharer.php?u=http://localhost:4000/view-code/2017/03/17/com-quantas-views-se-faz-um-APP/" rel="nofollow" target="_blank" title="Share on Facebook"><i class="fa fa-facebook-square"></i></a></li>
  <li><a href="http://www.linkedin.com/shareArticle?mini=true&url=http://localhost:4000/view-code/2017/03/17/com-quantas-views-se-faz-um-APP/" rel="nofollow" target="_blank" title="Share on Linkedlin"><i class="fa fa-linkedin-square"></i></a></li>
  <li><a href="https://plus.google.com/share?url=http://localhost:4000/view-code/2017/03/17/com-quantas-views-se-faz-um-APP/" rel="nofollow" target="_blank" title="Share on Google+"><i class="fa fa-google-plus-square"></i></a></li>
</ul>

				<blockquote>
  <p>Me chamo Ronan Rodrigo Nunes sou catarinense, não sulista e já usei Adobe Flex. Comecei minha carreira fazendo algumas gambiarras no Java, embarquei no trem do Ruby, desembarquei em Python, peguei conexão para Xamarin/C# e agora estou vivendo emoções com Swift! Sou desenvoledor iOS na (<a href="http://www.concretesolutions.com.br" target="_blank">Concrete Solutions</a>, estou aprendendo a andar de skate, escrevo na revista <a href="http://medium.com/cocoaacademymag" target="_blank">Cocoa Academy</a> e sou companheiro e marido de Nayara que me fez gostar de psicanálise e filosofia.</p>
</blockquote>

<h1 id="storyboards-xibs-view-code">Storyboards? XIBs? View Code?</h1>

<p>Tanto meus primeiros passos dentro do Xcode quanto alguns trabalhos profissionais foram feitos com o Storyboard. Eu não conseguia imaginar como alguém em sã consciência poderia substituir o arraste e solte do Interface Builder por código. Afinal, é muito simples.</p>

<p>Até que os Storyboards começaram a me incomodar e em seguida os XIBs também. Antes de preferir views construídas com código, eu era muito resistente à esta mudança. Mas, um dia comecei a refletir e concluí que isso era preguiça da minha parte. Afinal, quando fullstack eu escrevia HTML ao invés de arrastar e soltar componentes. Mas ainda assim, o Visual Format Language e o construtor do NSLayoutConstraint são enfadonhos.</p>

<p>O Visual Format Language é muito sensível à falhas de digitação. E o construtor do NSLayoutConstraint até hoje eu acho complexo.</p>

<p>Então participei de algumas talks do Thiago Lioy <a href="http://twitter.com/tpLioy" target="_blank">@tpLioy</a> sobre view code. Nessas talks ele mostrou como <a href="https://medium.com/cocoaacademymag/migrating-an-app-to-view-code-ffe3f1510408#.523t9mw60" target="_blank">migrou um projeto de Storyboard para views criadas com código</a> utilizando Snapkit. E o resultado, para minha surpresa, foi muito bom. Foi assim que comecei a gostar de view code, obrigado <a href="http://twitter.com/tpLioy" target="_blank">@tpLioy</a>. Mas ainda queria aprender a utilizar o que a Apple fez pra nós. Foi então que conheci o Anchor Layout.</p>

<h1 id="nslayoutanchor">NSLayoutAnchor</h1>

<p>A documentação da Apple descreve <code class="language-plaintext highlighter-rouge">NSLayoutAnchor</code> como sendo uma fábrica de classe, destinada a gerar objetos <code class="language-plaintext highlighter-rouge">NSLayoutConstraint</code>. Sendo os objetos do tipo <code class="language-plaintext highlighter-rouge">NSLayoutConstraint</code> os responsáveis por possibilitar o Auto Layout.</p>

<p>Resumindo, o <code class="language-plaintext highlighter-rouge">NSLayoutAnchor</code> facilitará a criação de constraints utilizadas no auto layout. Ao invés criar as constraints utilizando o construtor da classe <code class="language-plaintext highlighter-rouge">NSLayoutConstraint</code> são utilizados métodos das <code class="language-plaintext highlighter-rouge">UIView</code>s. A vantagem consistirá em um código mais limpo e de brinde uma checagem de tipo para evitar a criação de constraints inválidas. Essa checagem de tipo não permitirá, por exemplo, misturar atributos do eixo X com atributos do eixo Y.</p>

<blockquote>
  <p>Ainda que a classe <code class="language-plaintext highlighter-rouge">NSLayoutAnchor</code> tenha a checagem adicional de tipo, ainda é possível criar constraints inválidas. Por exemplo, o compilador permite que você configure a constraint <code class="language-plaintext highlighter-rouge">leadingAnchor</code> de uma view com a <code class="language-plaintext highlighter-rouge">leftAnchor</code> de outra view, pois ambas são instâncias de <code class="language-plaintext highlighter-rouge">NSLayoutXAxisAnchor</code>. Entretanto, Auto Layout não permite constraints que misturem atributos de <code class="language-plaintext highlighter-rouge">leading</code> e <code class="language-plaintext highlighter-rouge">trailing</code> com atributos de <code class="language-plaintext highlighter-rouge">left</code> ou <code class="language-plaintext highlighter-rouge">right</code>. Como resultado, as constraints vão quebrar em tempo de execução. <a href="https://developer.apple.com/reference/uikit/nslayoutanchor" target="_blank">NSLayoutAnchor</a></p>
</blockquote>

<h1 id="hora-da-aventura">Hora da aventura</h1>

<p>Para demonstrar como utilizar o auto layout na prática, eu criei um <a href="https://github.com/ronanrodrigo/autolayout" target="_blank">Playground</a>. Nesse playground existirá uma lista de cartões de visita. Onde os cartões têm uma exibição diferenciada conforme o plano que o usuário anunciante pagou. Com isso em mente, criei o layout abaixo.</p>

<p align="center"><img style="border-radius: 3px;" src="/img/ronanrodrigo/business-cards-list.png" /></p>

<h2 id="a-raiz-de-tudo">A raiz de tudo</h2>

<p>Como podem observar, todos os cartões de visita possuem os mesmos dados. Mas, exibidos de forma diferente. Se você já lidou com front-end Web, é como se tivéssemos um único HTML, com um CSS diferente para cada layout. Sendo assim, vou criar uma classe contendo todos os elementos do componente de cartão.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">import</span> <span class="kt">UIKit</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">BusinessCardComponents</span> <span class="p">{</span>

    <span class="k">let</span> <span class="nv">photoImageView</span><span class="p">:</span> <span class="kt">UIImageView</span> <span class="o">=</span> <span class="p">{</span>

        <span class="c1">// Aqui não vamos nos preocupar com tamanhos.</span>
        <span class="c1">// Isso vai ficar por conta da "folha de estilos".</span>
        <span class="k">let</span> <span class="nv">imageView</span> <span class="o">=</span> <span class="kt">UIImageView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>

        <span class="c1">// Se desejamos calcular dinamicamente os tamanhos</span>
        <span class="c1">// e posições das views, devemos alterar o valor dessa propriedade</span>
        <span class="c1">// para false. Por default, toda view criada via código</span>
        <span class="c1">// possui esse valor como true. Se criada via Interface Builder</span>
        <span class="c1">// o valor default é false.</span>
        <span class="n">imageView</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>

        <span class="k">return</span> <span class="n">imageView</span>
    <span class="p">}()</span>

    <span class="k">let</span> <span class="nv">nameLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="k">let</span> <span class="nv">titleLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="k">let</span> <span class="nv">emailLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

    <span class="k">let</span> <span class="nv">phoneLabel</span><span class="p">:</span> <span class="kt">UILabel</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">label</span> <span class="o">=</span> <span class="kt">UILabel</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">return</span> <span class="n">label</span>
    <span class="p">}()</span>

<span class="p">}</span>
</code></pre></div></div>

<p>Neste momento vamos ter código repetindo. Mas, calma, no final do post esse código vai estar refatorado e com as repetições eliminadas. E essa é uma das vantagens quando construímos views com código, temos liberdade para colocar em prática nossa criatividade e evoluir o que está sendo feito.</p>

<p>Pra fazer o layout do card referente ao plano Senior é utilizado o design pattern Dependency Injection. O objeto que será injetado vai ser um <code class="language-plaintext highlighter-rouge">BusinessCardComponents</code> que vai receber instruções de apresentação na <code class="language-plaintext highlighter-rouge">SeniorBusinessCardView</code>.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">SeniorBusinessCardView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">businessCardComponents</span><span class="p">:</span> <span class="kt">BusinessCardComponents</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">imageHeight</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">businessCardComponents</span><span class="p">:</span> <span class="kt">BusinessCardComponents</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">businessCardComponents</span> <span class="o">=</span> <span class="n">businessCardComponents</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="nf">setupViewHierarchy</span><span class="p">()</span>
        <span class="nf">setupConstraints</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="n">coder</span> <span class="nv">aDecoder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"init(coder:) has not been implemented"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupViewHierarchy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="p">)</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="p">)</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="p">)</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="p">)</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupConstraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">topAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">heightAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalToConstant</span><span class="p">:</span> <span class="n">imageHeight</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="o">.</span><span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">bottomAnchor</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Embora sejam poucas constraints, o código ficou um tanto quanto extenso. Por conta da dor de ter que fazer esse código várias vezes criei uma extension. Essa extension vai facilitar ainda mais a utilização de Layout Anchor. Abaixo, mostro como ficou a extension e como ficou o código depois.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">extension</span> <span class="kt">UIView</span> <span class="p">{</span>

    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="nf">topAnchor</span><span class="p">(</span><span class="n">equalTo</span> <span class="nv">anchor</span><span class="p">:</span> <span class="kt">NSLayoutYAxisAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="n">topAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">anchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">constant</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>

    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="nf">bottomAnchor</span><span class="p">(</span><span class="n">equalTo</span> <span class="nv">anchor</span><span class="p">:</span> <span class="kt">NSLayoutYAxisAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="n">bottomAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">anchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">constant</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>

    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="nf">leadingAnchor</span><span class="p">(</span><span class="n">equalTo</span> <span class="nv">anchor</span><span class="p">:</span> <span class="kt">NSLayoutXAxisAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="n">leadingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">anchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">constant</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>

    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="nf">trailingAnchor</span><span class="p">(</span><span class="n">equalTo</span> <span class="nv">anchor</span><span class="p">:</span> <span class="kt">NSLayoutXAxisAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="n">trailingAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">anchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">constant</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>

    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="nf">heightAnchor</span><span class="p">(</span><span class="n">equalTo</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="n">heightAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalToConstant</span><span class="p">:</span> <span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>

    <span class="kd">@discardableResult</span> <span class="kd">func</span> <span class="nf">widthAnchor</span><span class="p">(</span><span class="n">equalTo</span> <span class="nv">height</span><span class="p">:</span> <span class="kt">CGFloat</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="k">Self</span> <span class="p">{</span>
        <span class="n">widthAnchor</span><span class="o">.</span><span class="nf">constraint</span><span class="p">(</span><span class="nv">equalToConstant</span><span class="p">:</span> <span class="n">height</span><span class="p">)</span><span class="o">.</span><span class="n">isActive</span> <span class="o">=</span> <span class="kc">true</span>
        <span class="k">return</span> <span class="k">self</span>
    <span class="p">}</span>

<span class="p">}</span>
</code></pre></div></div>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">SeniorBusinessCardView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">defaultMargin</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="c1">// ...</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupConstraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">topAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">heightAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">imageHeight</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">bottomAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">bottomAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Ocupou mais linhas pois achei conveniente quebra-las. Mas ao todo foi uma redução de quase 800 caracteres. E para além da economia de caracteres, ficou um código mais fácil de ler. Continuando, a próxima tela é referente ao plano Full.</p>

<p>Agora, quando o nosso aplicativo exibir cartões de visita do plano Full, deve mostrar a imagem ao lado dos dados, ao invés de em cima. Para isso, criei uma view chamada <code class="language-plaintext highlighter-rouge">rightContentContainer</code> que vai conter o conteúdo à direita da imagem, ou seja, com seu <code class="language-plaintext highlighter-rouge">leading</code> igual ao <code class="language-plaintext highlighter-rouge">trailing</code> da imagem.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">FullBusinessCardView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">businessCardComponents</span><span class="p">:</span> <span class="kt">BusinessCardComponents</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">imageSize</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">80</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">defaultMargin</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">5</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">rightContentContainer</span><span class="p">:</span> <span class="kt">UIView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">view</span> <span class="o">=</span> <span class="kt">UIView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="n">view</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">return</span> <span class="n">view</span>
    <span class="p">}()</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">businessCardComponents</span><span class="p">:</span> <span class="kt">BusinessCardComponents</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">businessCardComponents</span> <span class="o">=</span> <span class="n">businessCardComponents</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="nf">setupViewHierarchy</span><span class="p">()</span>
        <span class="nf">setupConstraints</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="n">coder</span> <span class="nv">aDecoder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"init(coder:) has not been implemented"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupViewHierarchy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="p">)</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">rightContentContainer</span><span class="p">)</span>
        <span class="n">rightContentContainer</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="p">)</span>
        <span class="n">rightContentContainer</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="p">)</span>
        <span class="n">rightContentContainer</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="p">)</span>
        <span class="n">rightContentContainer</span><span class="o">.</span><span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupConstraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">topAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">widthAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">imageSize</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">heightAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">imageSize</span><span class="p">)</span>

        <span class="n">rightContentContainer</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">heightAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">imageSize</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">)</span>

        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">leadingAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">rightContentContainer</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Agora para fazer a view do plano Junior, vou sugerir uma forma diferente. Utilizando Stack Views ao invés do Anchor Layout. Particularmente, tanto com Interface Builder quanto através de código, faço o layout com Constraints e depois altero para usar Stack Views quando adequado.</p>

<h2 id="stack-views">Stack Views</h2>

<p>Como o nome sugere, é um objeto que vai empilhar views na horizontal ou vertical. Por conta dessa estrutura de pilha, evitamos a criação de algumas constraints. Tudo o que foi demonstrado anteriormente usando Anchor Layout pode ser simplificado ainda mais com o uso das Stack Views.</p>

<blockquote>
  <p>A stack view está de acordo com Auto Layout (é baseada no layout de constraints do sistema) para organizar  e alinhar uma lista de views de acordo com sua especificação. Para tirar proveito da stack view, você precisa saber o básico sobre as contraints do Auto Layout, como descrito no <a href="https://developer.apple.com/library/etc/redirect/xcode/content/1189/documentation/UserExperience/Conceptual/AutolayoutPG/index.html#//apple_ref/doc/uid/TP40010853" target="_blank">Guia do Auto Layout</a>. <a href="https://developer.apple.com/reference/appkit/nsstackview" target="_blank">NSStackView</a></p>
</blockquote>

<p>O código da <code class="language-plaintext highlighter-rouge">JuniorBusinessCardView</code> ficou ainda mais simples e com menos linhas na parte que define as constraints. Além do posicionamento das views, também é possível alterar tamanho de fontes, cores e assim por diante, conforme código abaixo.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">JuniorBusinessCardView</span><span class="p">:</span> <span class="kt">UIView</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">businessCardComponents</span><span class="p">:</span> <span class="kt">BusinessCardComponents</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">imageSize</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">defaultMargin</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">defaultFontSise</span><span class="p">:</span> <span class="kt">CGFloat</span> <span class="o">=</span> <span class="mi">10</span>

    <span class="kd">private</span> <span class="k">let</span> <span class="nv">stackContentContainer</span><span class="p">:</span> <span class="kt">UIStackView</span> <span class="o">=</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">stack</span> <span class="o">=</span> <span class="kt">UIStackView</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="o">.</span><span class="n">vertical</span>
        <span class="n">stack</span><span class="o">.</span><span class="n">translatesAutoresizingMaskIntoConstraints</span> <span class="o">=</span> <span class="kc">false</span>
        <span class="k">return</span> <span class="n">stack</span>
    <span class="p">}()</span>

    <span class="nf">init</span><span class="p">(</span><span class="nv">businessCardComponents</span><span class="p">:</span> <span class="kt">BusinessCardComponents</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">businessCardComponents</span> <span class="o">=</span> <span class="n">businessCardComponents</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">frame</span><span class="p">:</span> <span class="o">.</span><span class="n">zero</span><span class="p">)</span>
        <span class="nf">setupViewHierarchy</span><span class="p">()</span>
        <span class="nf">setupConstraints</span><span class="p">()</span>
        <span class="nf">setupTextFonts</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">required</span> <span class="nf">init</span><span class="p">?(</span><span class="n">coder</span> <span class="nv">aDecoder</span><span class="p">:</span> <span class="kt">NSCoder</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">fatalError</span><span class="p">(</span><span class="s">"init(coder:) has not been implemented"</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupViewHierarchy</span><span class="p">()</span> <span class="p">{</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="p">)</span>
        <span class="nf">addSubview</span><span class="p">(</span><span class="n">stackContentContainer</span><span class="p">)</span>
        <span class="n">stackContentContainer</span><span class="o">.</span><span class="nf">addArrangedSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="p">)</span>
        <span class="n">stackContentContainer</span><span class="o">.</span><span class="nf">addArrangedSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="p">)</span>
        <span class="n">stackContentContainer</span><span class="o">.</span><span class="nf">addArrangedSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="p">)</span>
        <span class="n">stackContentContainer</span><span class="o">.</span><span class="nf">addArrangedSubview</span><span class="p">(</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupConstraints</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">topAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">leadingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">widthAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">imageSize</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">heightAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">imageSize</span><span class="p">)</span>

        <span class="n">stackContentContainer</span>
            <span class="o">.</span><span class="nf">topAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">topAnchor</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">leadingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">trailingAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">trailingAnchor</span><span class="p">,</span> <span class="nv">constant</span><span class="p">:</span> <span class="n">defaultMargin</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">bottomAnchor</span><span class="p">(</span><span class="nv">equalTo</span><span class="p">:</span> <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">photoImageView</span><span class="o">.</span><span class="n">bottomAnchor</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kd">func</span> <span class="nf">setupTextFonts</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">[</span><span class="n">businessCardComponents</span><span class="o">.</span><span class="n">nameLabel</span><span class="p">,</span>
         <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">titleLabel</span><span class="p">,</span>
         <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">emailLabel</span><span class="p">,</span>
         <span class="n">businessCardComponents</span><span class="o">.</span><span class="n">phoneLabel</span><span class="p">]</span><span class="o">.</span><span class="n">forEach</span> <span class="p">{</span> <span class="nv">$0</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="o">.</span><span class="nf">systemFont</span><span class="p">(</span><span class="nv">ofSize</span><span class="p">:</span> <span class="n">defaultFontSise</span><span class="p">)</span> <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="bonus---trafegando-dados">Bonus - Trafegando dados</h2>

<p>Poderia ser utilizado uma Entity/Value Object qualquer pra dentro do componente que possui a foto e as labels. Mas para fazer um código mais limpo, devemos solicitar somente os dados necessários e geralmente as Entities possuem dados além do que vai ser exibido.</p>

<p>Além de não utilizar todos os dados de uma Entity, o(a) próximo(a) programador(a) não vai saber o que daquela entity deve ser preenchido para que a view funcione corretamente. A menos que ele(a) abra a classe <code class="language-plaintext highlighter-rouge">BusinessCardComponents</code> e descubra todos os valores utilizados. Pra resolver essa dor tenho duas sugestões.</p>

<p>A primeira sugestão é colocar na função que vai popular a tela, todos os parâmetros utilizados. O ruim disso é que podemos ter uma função com uma assinatura muito extensa. Espia:</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">final</span> <span class="kd">class</span> <span class="kt">BusinessCardComponents</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">photo</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">phone</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">email</span><span class="p">:</span> <span class="kt">String</span> <span class="o">...</span> <span class="err">∞</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>E a segunda alternativa eu tenho usado em diversos momentos. Criar um <code class="language-plaintext highlighter-rouge">typealias</code> daquilo que estaria na assinatura do método. Assim a assinatura fica menor e ainda podemos contar com o help (option + click) do Xcode.</p>

<div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">typealias</span> <span class="kt">BusinessCardParams</span> <span class="o">=</span> <span class="p">(</span><span class="nv">photo</span><span class="p">:</span> <span class="kt">UIImage</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">phone</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="nv">email</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span>

<span class="kd">final</span> <span class="kd">class</span> <span class="kt">BusinessCardComponents</span> <span class="p">{</span>
    <span class="c1">// ...</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="kt">BusinessCardParams</span><span class="p">)</span> <span class="p">{</span>
         <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">let</span> <span class="nv">params</span> <span class="o">=</span> <span class="kt">BusinessCardParams</span><span class="p">(</span><span class="nv">photo</span><span class="p">:</span> <span class="n">somePhoto</span><span class="p">,</span> <span class="nv">name</span><span class="p">:</span> <span class="s">"Juca"</span><span class="p">,</span> <span class="nv">title</span><span class="p">:</span> <span class="s">"Desenvolvedor de Software"</span><span class="p">,</span> <span class="nv">phone</span><span class="p">:</span> <span class="s">"(11) 1111-1111"</span><span class="p">,</span> <span class="nv">email</span><span class="p">:</span> <span class="s">"oi@juca.com"</span><span class="p">)</span>
<span class="k">let</span> <span class="nv">seniorBsinessCardComponent</span> <span class="o">=</span> <span class="kt">BusinessCardComponents</span><span class="p">(</span><span class="nv">params</span><span class="p">:</span> <span class="n">params</span><span class="p">)</span>
</code></pre></div></div>

<p align="center"><img style="border-radius: 3px;" src="/img/ronanrodrigo/xcode-help.png" /></p>

<h1 id="conclusão">Conclusão</h1>

<p>Quando se trata de views construídas com código temos diversas soluções e “não existe bala de prata”. O lado positivo é que podemos trabalhar com nossa criatividade para sermos mais produtivos. Acredito que o Interface Builder acaba nos limitando e nos acomodando.</p>

<p>Em termos práticos se a escolha fosse utilizar Storyboard ou XIBs teríamos três telas desenhadas com pouco reaproveitamento. Além disso, ficaria mais difícil de criar testes e o tráfego de dados também ficaria mais oneroso.</p>

<p>As views com código requerem um novo aprendizado. Mas é uma curva de aprendizado baixa. Experimente sair da zona de conforto do Interface Builder, aprenderás mais sobre UIKit, vai aprimorar sua criatividade e futuramente, aos poucos, aumentará sua produtividade.</p>

<h3 id="agradecimentos">Agradecimentos</h3>

<p>Agradeço aos companheiros da Concrete Solutions por me ajudarem a oxigenar meu cérebro. Agradeço também à minha companheira Nayara. Ela quem me incentivou a buscar minha especialização fora da minha cidade natal e fisicamente longe dela, estou com saudades ❤️.</p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/ios/2017/03/16/swift-enums/" data-toggle="tooltip" data-placement="top" title="Enums para o nosso bem">&larr; Post Anterior</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/server/2017/03/18/server-side-caracteristicas-de-um-servidor/" data-toggle="tooltip" data-placement="top" title="Server-side: características de um servidor">Próximo Post &rarr;</a>
                    </li>
                    
                </ul>

                <!-- Disqus Content -->

                <div id="disqus_thread">
                    <script>
                        /**
                        * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
                        * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
                        */

                        /*
                        var disqus_config = function () {
                            this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
                            this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
                        };
                        */

                        (function() { // DON'T EDIT BELOW THIS LINE
                        var d = document, s = d.createElement('script');

                        s.src = '//equinocios.disqus.com/embed.js';

                        s.setAttribute('data-timestamp', +new Date());
                        (d.head || d.body).appendChild(s);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
                </div>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                </ul>
                <p class="copyright text-muted">A odisseia do puto — Raimundo Pessoa & Frederico Do</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


</body>

</html>
